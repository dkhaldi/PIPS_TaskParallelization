delete altret01

#############################################################################
#
# Hidden Return Code (HRC) Version: not precisely analyzable because the two
# call sites to FOO are analyzed simultaneously
#
#############################################################################

create altret01 altret01.f

setproperty ABORT_ON_USER_ERROR TRUE

setproperty PARSER_SUBSTITUTE_ALTERNATE_RETURNS "HRC"
# setproperty PRETTYPRINT_ALL_DECLARATIONS TRUE
setproperty PRETTYPRINT_REGENERATE_ALTERNATE_RETURNS TRUE

activate TRANSFORMERS_INTER_FULL
activate INTERPROCEDURAL_SUMMARY_PRECONDITION
activate PRECONDITIONS_INTER_FULL

echo
echo Code generated by PIPS with transformers for FOO (option HRC)
echo

activate PRINT_CODE_TRANSFORMERS
display PRINTED_FILE[FOO]

echo
echo # Code generated by PIPS with preconditions for ALTRET01 (option HRC)
echo

activate PRINT_CODE_PRECONDITIONS
display PRINTED_FILE(ALTRET01)

apply UNSPLIT

echo
echo # Unsplit version
echo

shell cat altret01.database/Src/altret01.f

echo
echo # Compile and Compare
echo

shell pips_validation_exe.sh -crc altret01

close
delete altret01


#######################################################################
#
# STOP Version: Analyzable because of STOP
#
#######################################################################


create altret01 altret01.f

setproperty ABORT_ON_USER_ERROR TRUE

setproperty PARSER_SUBSTITUTE_ALTERNATE_RETURNS "STOP"
# setproperty PRETTYPRINT_ALL_DECLARATIONS TRUE
setproperty PRETTYPRINT_REGENERATE_ALTERNATE_RETURNS TRUE

activate TRANSFORMERS_INTER_FULL
activate INTERPROCEDURAL_SUMMARY_PRECONDITION
activate PRECONDITIONS_INTER_FULL

echo
echo # Code generated by PIPS with transformers for FOO (option STOP)
echo

activate PRINT_CODE_TRANSFORMERS
display PRINTED_FILE[FOO]

echo
echo # Code generated by PIPS with preconditions for ALTRET01 (option STOP)
echo

activate PRINT_CODE_PRECONDITIONS
display PRINTED_FILE(ALTRET01)

capply SIMPLIFY_CONTROL[%ALL]

apply UNSPLIT

echo
echo # Whole code generated by PIPS after dead code elimination (option STOP)
echo

shell cat altret01.database/Src/altret01.f

echo
echo # Execute code generated by PIPS
echo

shell pips_validation_exe.sh --crc altret01

close
delete altret01
quit
