delete altret09

setproperty ABORT_ON_USER_ERROR FALSE

create altret09 altret09.src/altret09.f \
	altret09.src/foo.f

# do not set because the a.out exit with 1 thus it
# triggers the abort...
#setproperty ABORT_ON_USER_ERROR TRUE

setproperty PARSER_SUBSTITUTE_ALTERNATE_RETURNS "STOP"
# setproperty PRETTYPRINT_ALL_DECLARATIONS TRUE
setproperty PRETTYPRINT_REGENERATE_ALTERNATE_RETURNS TRUE

#shell cat altret09.src/altret09.f

# this is a very bad non portable idea -- FC
# pips_validation_exe can handle one file, not two:-(

shell (cd altret09.src; ${PIPS_F77:-f77} -o altret09.exe \
	altret09.f \
	foo.f; mv altret09.exe ..)

echo
echo Execute initial code
echo

shell ./altret09.exe
shell rm altret09.exe

echo
echo Code generated by PIPS for FOO
echo

display PRINTED_FILE(FOO)

echo
echo Code generated by PIPS for ALTRET09
echo

display PRINTED_FILE(ALTRET09)

apply UNSPLIT

echo
echo Whole code generated by PIPS
echo

shell cat altret09.database/Src/foo.f

shell (cd altret09.database; ${PIPS_F77:-f77} -o altret09.exe \
	ALTRET09/ALTRET09.f \
	Src/foo.f; mv altret09.exe ..)

echo
echo Execute code generated by PIPS for FOO and initial code for ALTRET09
echo

shell ./altret09.exe
shell rm altret09.exe

close
delete altret09
quit
