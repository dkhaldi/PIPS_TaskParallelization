
Code generated by PIPS for SET_I_PIPS_RETURN_CODE_

      SUBROUTINE SET_I_PIPS_RETURN_CODE_(IRC)
      COMMON /PIPS_RETURN_CODE_COMMON/IRC_SHARED
      IRC_SHARED = IRC                                                  0003
      END

Code generated by PIPS for GET_I_PIPS_RETURN_CODE_

      SUBROUTINE GET_I_PIPS_RETURN_CODE_(IRC)
      COMMON /PIPS_RETURN_CODE_COMMON/IRC_SHARED
      IRC = IRC_SHARED                                                  0003
      END

Code generated by PIPS for FOO


      SUBROUTINE FOO(*, I)
      PRINT *, "foo is entered with ", I                                0003
      IF (I.GT.0) GOTO 99999                                            0004
      I = I+1                                                           0008
      CALL SET_I_PIPS_RETURN_CODE_(0)                                   0009
      RETURN
99999 CONTINUE
      PRINT *, 'RETURN 1 in FOO'                                        0005
      CALL SET_I_PIPS_RETURN_CODE_(1)                                   0006
      END

Code generated by PIPS for ALTRET07

      PROGRAM ALTRET07

C     Check link-edit issues

      I = 0                                                             0005

      CALL FOO(*123, I)                                                 0007
      CALL GET_I_PIPS_RETURN_CODE_(I_PIPS_RETURN_CODE_)                 0007
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0007
      PRINT *, "First standard return from foo"                         0008

      CALL FOO(*123, I)                                                 0010
      CALL GET_I_PIPS_RETURN_CODE_(I_PIPS_RETURN_CODE_)                 0010
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0010
C     This should not happen!
      PRINT *, "Second standard return from foo"                        0012

      PRINT *, 'STOP 0 in ALTRET07'                                     0014
      STOP 0                                                            0015

123   CONTINUE                                                          0017
      PRINT *, 'STOP 1 in ALTRET07'                                     0018
      STOP '1 in ALTRET07'                                              0019

      END

Whole code generated by PIPS

!!
!! file for altret07.f
!!
      PROGRAM ALTRET07

C     Check link-edit issues

      I = 0                                                             0005

      CALL FOO(*123, I)                                                 0007
      CALL GET_I_PIPS_RETURN_CODE_(I_PIPS_RETURN_CODE_)                 0007
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0007
      PRINT *, "First standard return from foo"                         0008

      CALL FOO(*123, I)                                                 0010
      CALL GET_I_PIPS_RETURN_CODE_(I_PIPS_RETURN_CODE_)                 0010
      IF (I_PIPS_RETURN_CODE_.EQ.1) GOTO 123                            0010
C     This should not happen!
      PRINT *, "Second standard return from foo"                        0012

      PRINT *, 'STOP 0 in ALTRET07'                                     0014
      STOP 0                                                            0015

123   CONTINUE                                                          0017
      PRINT *, 'STOP 1 in ALTRET07'                                     0018
      STOP '1 in ALTRET07'                                              0019

      END

      SUBROUTINE FOO(*, I)
      PRINT *, "foo is entered with ", I                                0003
      IF (I.GT.0) GOTO 99999                                            0004
      I = I+1                                                           0008
      CALL SET_I_PIPS_RETURN_CODE_(0)                                   0009
      RETURN
99999 CONTINUE
      PRINT *, 'RETURN 1 in FOO'                                        0005
      CALL SET_I_PIPS_RETURN_CODE_(1)                                   0006
      END
      SUBROUTINE SET_I_PIPS_RETURN_CODE_(IRC)
      COMMON /PIPS_RETURN_CODE_COMMON/IRC_SHARED
      IRC_SHARED = IRC                                                  0003
      END
      SUBROUTINE GET_I_PIPS_RETURN_CODE_(IRC)
      COMMON /PIPS_RETURN_CODE_COMMON/IRC_SHARED
      IRC = IRC_SHARED                                                  0003
      END
#
# compile run compare both altret07
#
