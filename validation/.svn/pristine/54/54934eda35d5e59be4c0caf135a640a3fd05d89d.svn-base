regions are wrong + performance bug in linear
