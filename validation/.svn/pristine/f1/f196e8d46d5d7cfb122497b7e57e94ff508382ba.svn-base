
C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

C
C     1993 version - Modified by Beatrice Creusillet for PIPS -
C
C     MODIFICATIONS:
C
C     AUGUST 1995:
C     ~~~~~~~~~~~~
C     - CXxxxxx and CYyyyyy commentaries removed for clarity.
C     - CPUTIM and ELAPSE subroutines uncommented.
C     - BLOCK DATA moved in main procedure.
C     - Macro definition LSTMOD(MODEHI) in module DEALSE replaced where
C       it is used.
C     - (1.,0.) replaced by CMPLX(1.,0.) wherever needed.
C     - In RUNINF, computed GOTO's are replaced by block if's.
C     - Passed through stf; one empty if block removed afterwards.
C     - Add common /TIMING/ in DATAST, TEMPFO, TEMPHY, PSIFOU, PSIPHY,
C       ZETAFO, ZETAPH, VVELFO, VVELPH, UVELFO, UVELPH, DEALSE, in order
C       to help the interprocedural propagation.
C     - Common //NMBRS/ declared in RCS, CSR, ACAC, SCSC to
C       propagate major predicates (like N2P==129) downwards to FTRVMT 
C       (fi, June 1993).
C     - Add common /FT/ in TEMPHY
C     - Add common /MEMORY/ in OCEAN
C     - variable NUMBER in common /DEBUG/ renamed into NUM1 to avoid clashes
C       with variable NUMBER in common /OPTONS/
C     - use full declaration of /FT/ in UVELFO (Francois Irigoin)
C
C******NOTE: USE OF MACHINE-DEPENDENT CONSTANT: ZERO IN SUBROUTINE RUNIN
C
C            ZERO = 1.0E-200 (MAY HAVE TO REPLACE WITH YOUR MACHINES
C                             RELATIVE PRECISION FOR REAL DATA TYPE)
C

C***********************************************************************
C                        OCEAN FORTRAN PROGRAMS
C                        CREATION DATE: 3/22/81
C***********************************************************************
      PROGRAM OCEAN
C
C  D(Z)/DT + (U,V).GRAD(Z) = RNU*DELSQ(Z) + ALPHA*D(TEMP)/DX
C
C  D(TEMP)/DT + (U,V).GRAD(TEMP) = RKAPA*DELSQ(TEMP) + BETA*V
C
C
C
C THIS PROGRAM SIMULATES TWO-DIMENSIONAL FLUID FLOW ON A   (N2+1) * N1
C GRID. IT IS POSSIBLE TO SPECIFY NON-LINEAR DISTRIBUTION OF DATA POINTS
C THE Y-DIRECTION (THE FIRST INDEX CORRESPONDS TO Y DIRECTION, SECOND TO
C X DIRECTION). N1 AND N2 HAVE TO BE POWERS OF TWO GREATER OR EQUAL TO 8
C
C THE PROGRAM USES LARGE CORE MEMORY. IT REQUIRES 8*(N2+1)*N1+(N2-1)*(N2
C WORDS OF IT. IF NOTEMP = 1 IT IS POSSIBLE TO SAVE 2*(N2+1)*N1 WORDS,
C IF LMAPP = 1 YOU SAVE ADDITIONAL (N2-1)*(N2+1) WORDS.
C
C IF  LMAPP = 2 , LCM REQUIREMENTS ARE AT LEAST  3 * (N2-1) * (N2-1)
C MORE MEMORY COULD BE NEEDED IN THIS CASE BECAUSE OF EIGSET AND LCMRQR.
C
C
C FOR CDC7600 RUNS: DELETE ROUTINES LCMREQ, IN AND OUT FROM THE END OF
C                   THIS PACKAGE. ON CDC7600 THE LCM IS USED THROUGH
C                   THE ASSEMBLY ROUTINES.
C
C                   LIBRARY.
C FOR CRAY-1 RUNS : DELETE ROUTINES SECOND, DATE, TIME, EXSET AND
C                   LOG2 FROM THE END OF THIS PACKAGE. THEY ARE
C                   OBTAINED AT LOAD TIME FROM CRAY LIBRARIES AND
C                   FFTLIB.
C                   ALSO, ADJUST THE SIZE OF PARAMETER LCMSIZ IN
C                   THE ROUTINE LCMREQ SO THAT THE COMMON IS LARGE
C                   ENOUGH TO EMULATE CDC7600 LCM REQUIRED FOR THE RUN.
C
C THE FOLLOWING PARAMETERS DEFINE THE SIZE OF THE RUN:
C
      PARAMETER (NX=128,NY=128)
      PARAMETER (NA1=2* (NY+1),NA2=NX/2,NE=NY-1,NW1=NY+1)
      PARAMETER (NW2=128,NEX=256)
      PARAMETER (NI=2*NY-1,NEQ=3*NY-2,NCW2=2*NW1+1,NCW3=4*NW1+1)
C
C PLEASE REFER TO THE DIMENSIONING AND EQUIVALENCING INSTRUCTIONS IN
C THE CASE YOUR COMPILER CANNOT HANDLE PARAMETER STATEMENTS...
C COMMON BLOCKS:
C
      COMMON /FT/NPTS,NSKIP,MTRN,MSKIP,ISIGN,LOG,IEXSHF
C
C THE DIMENSION OF  GSOLV  HAS TO BE AT LEAST (N2-1)
C
      COMMON /SOLV/LVECT,LSKIP,NVECT,NVSKIP,GSOLV(127)
C
C THE DIMENSIONS OF  GMAPP  AND  G  HAVE TO BE AT LEAST (N2+1)
C
      COMMON /MAPING/GMAPP(129),G(129)
      COMMON /MFLOW/U(129)
      COMMON /DATA/ALPHA,BETA,BOXX,H,RNU,RKAPA,DT,DTT,T,NSTEPS
      COMMON /OPTONS/N1,N2,NUMBER,KDATA,LMAPP,NOTEMP,KTA,KTAPE,KSM,KPP,
     +       KZP,KTP,KUP,KVP,KPF,KZF,KTF,KUF,KVF,KPRESS,NOALS
      COMMON /PI/PI
      COMMON /NMBRS/N1H,N1Q,N1E,N2M,N2P,N2DP,N2DM,N2PD
      COMMON /EXSIZE/NMAX2
      COMMON /LADDR/LZN,LTN,LPN,LZO,LTO,LPY,LZX,LZY,LEIG,LE,LH,LEV
      COMMON /TIMING/TXXXIN,TXXOUT,TXXRCS,TXXCSR,TXSCSC,TXACAC,TFTVMT,
     +       TXSHUF,TUSHUF,TXPRNT,TXLOG2,EXXRCS,EXXCSR,EXSCSC,EXACAC,
     +       EFTVMT,NXXXIN,NXXOUT,NXXRCS,NXXCSR,NXSCSC,NXACAC,NFTVMT,
     +       NXSHUF,NUSHUF,NXPRNT,NXLOG2
      PARAMETER (LCMSIZ=165117)
      COMMON /MEMORY/MEMSIZ,RM(LCMSIZ)
C
C
C COMPLEX ARRAYS HAVE TO BE DIMENSIONED EXACTLY AS THE FORMULAS SAY:
C            CA        (N2+1) X N1/2
C            CWORK     N2+1
C            CWORK2    N2+1
C            CWORK3    N2+1
C            EX        MAX(2*N2, N1)
C
C EX ARRAY MUST NOT BE THE FIRST ARRAY IN THE MEMORY.
C
      COMPLEX CA(NW1,NA2),CWORK(NW1),CWORK2(NW1)
      COMPLEX CWORK3(NW1),EX(NEX),CF
C
C REAL ARRAYS HAVE TO BE DIMENSIONED EXACTLY AS THE FORMULAS SAY:
C            A      2*(N2+1) X N1/2
C            E      (N2-1)   X (N2-1)
C            WORK   N2+1     X MAX(6, 2*MIN(64, N1/2))   (AT LEAST)
C            EVAL   N2-1
C            IR     N2-1
C            IC     N2-1
C
      REAL A(NA1,NA2),E(NE,NE)
      REAL WORK(NW1*NW2)
      REAL EVAL(NE),IR(NE),IC(NE)
      INTEGER VALID
C
C EQUIVALENCE STATEMENTS ARE SAVING MEMORY SPACE. THE FOLLOWING PATTERN
C HAS TO BE FOLLOWED EXACTLY:
C
C     A-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     CA+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     EVAL+-+IR-+-+-IC+-+-+E+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C
C
C     WORK+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
C     CWORK-+-+-+CWORK2-+-+-CWORK3+-+-+
C
C      EQUIVALENCE (A,CA,EVAL), (A(NY),IR), (A(NI),IC), A(NEQ),E) - ORGI
C      EQUIVALENCE (A,CA,EVAL), (EVAL(NY),IR), (EVAL(NI),IC),
C     *             (EVAL(NEQ),E) - MACFARLANE'S FIX. BAD.
C POINTER'S FIX. ANSI REQUIRES THAT THE NUMBER OF SUBSCRIPTS MATCH
C THE NUMBER OF DIMENSIONS OF THE ARRAY. THAT WAS THE PROBLEM WITH
C THE ORGINAL STATEMENT. THE PROBLEM WITH MACFARLANE'S FIX IS THAT
C NY,NI,NEQ>NE (THE DIMENSION OF EVAL). HERE 3*NE+1-NA1 IS THE 3*NE+1TH
C ELEMENT OF A AND 3*NE+1 = NEQ.
      EQUIVALENCE (A,CA,EVAL), (A(NY,1),IR), (A(NI,1),IC),
     +            (A(3*NE+1-NA1,2),E)
      EQUIVALENCE (WORK,CWORK), (WORK(NCW2),CWORK2), (WORK(NCW3),CWORK3)
      COMMON /VERIFY/VDAT(15),CDAT(15)
      COMMON /DEBUG/NUM1,TLAST
C
C     former BLOCK DATA
C
C
      DATA TXXXIN,TXXOUT,TXXRCS,TXXCSR,TXSCSC,TXACAC,TFTVMT/0.,0.,0.,0.,
     +     0.,0.,0./
      DATA TXSHUF,TUSHUF,TXPRNT,TXLOG2/0.,0.,0.,0./
      DATA EXXRCS,EXXCSR,EXSCSC,EXACAC,EFTVMT/0.,0.,0.,0.,0./
      DATA NXXXIN,NXXOUT,NXXRCS,NXXCSR,NXSCSC,NXACAC,NFTVMT/0,0,0,0,0,0,
     +     0/
      DATA NXSHUF,NUSHUF,NXPRNT,NXLOG2/0,0,0,0/
      DATA VDAT/0.10000E+03,-0.10000E+03,0.10000E-04,-0.10000E+03,
     +     -0.15708E+01,0.99983E+02,-0.18147E+01,-0.20427E+01,
     +     -0.22452E+01,-0.24181E+01,0.95976E+02,-0.95977E+02,
     +     0.10000E-04,-0.95978E+02,-0.25589E+01/
C
C PI IS A USEFULL CONSTANT
C
      DATA PI/3.141592653589793/
      DATA NUM1/1/,TLAST/0.0/

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

C
C
C
C NOW WE CAN START WITH THE PROGRAM...
C SUBROUTINE START TELLS OCEAN WHAT TO DO:
C
      CALL CPUTIM(CPU1)                                                 0183

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      CALL ELAPSE(TCLCK1)                                               0184

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      OPEN (UNIT=1,FILE='OCV')                                          0185

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      OPEN (UNIT=6,FILE='OCO6')                                         0186

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      WRITE (1, 9000)                                                   0187

C  P() {NFTVMT==0, NUM1==1, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}


      CALL START(NX, NY)                                                0189

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N2==128, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

C
C IF  LMAPP = 1 , H  (THE SIZE OF THE BOX IN Y DIRECTION)  SHOULD BE
C SPECIFIED IN THE MAIN PROGRAM.
C
      H = PI                                                            0194

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N2==128, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

C
C DEFINING CONSTANTS THAT WILL BE NEEDED:
C
      N1H = N1/2                                                        0198

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1H,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1H==64, N2==128, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N1Q = N1/4                                                        0199

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1H,N1Q,N2,NOALS,NOTEMP,NUMBER) {KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1H==64, N1Q==32, N2==128, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N1E = N1/8                                                        0200

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,NOALS,NOTEMP,NUMBER) {KDATA==1,
C    KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2M = N2-1                                                        0201

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2M,NOALS,NOTEMP,NUMBER) {KDATA==1,
C    KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2M==127,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      N2P = N2+1                                                        0202

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2M,N2P,NOALS,NOTEMP,NUMBER)
C    {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2M==127, N2P==129, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2DP = 2*N2+1                                                     0203

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DP,N2M,N2P,NOALS,NOTEMP,NUMBER)
C    {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DP==257, N2M==127, N2P==129, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2DM = 2*N2-1                                                     0204

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,NOALS,NOTEMP,
C    NUMBER) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0}

      N2PD = 2*N2P                                                      0205

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      NW = N2PD*N1H                                                     0206

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0}

      NWH = NW/2                                                        0207

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWH) {KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0,
C    NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 2NWH<=NW, NW<=2NWH+1}

      NWQ = NW/4                                                        0208

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      NWEIG = N2M                                                       0209

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (LMAPP.NE.1) NWEIG = (N2M+3)*N2M                               0210

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0,
C    NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      NMAX2 = MAX(2*N2, N1)                                             0211

C  P(KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,
C    KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K1Q = N1E+1                                                       0212

C  P(K1Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      K2Q = K1Q+N1E                                                     0213

C  P(K1Q,K2Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,
C    KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K2Q==33,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

      K3Q = K2Q+N1E                                                     0214

C  P(K1Q,K2Q,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,
C    KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K2Q==33,
C    K3Q==49, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0,
C    NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K1QM = K1Q-1                                                      0215

C  P(K1Q,K1QM,K2Q,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,KUF,
C    KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,
C    N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K3Q==49, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K2QM = K2Q-1                                                      0216

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,KTF,KTP,
C    KUF,KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LMAPP==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      K3QM = K3Q-1                                                      0217

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LMAPP,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LMAPP==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW, NW<=2NWH+1, 4NWQ<=NW,
C    NW<=4NWQ+3}

C
C LCM ALLOCATION AND COMPUTATION OF ADDRESSES:
C
      LARGE = 8*NW                                                      0221

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (NOTEMP.EQ.1) LARGE = 6*NW                                     0222

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

      IF (LMAPP.NE.2) THEN                                              0223

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

C
         LARGE = LARGE+NWEIG                                            0225

      ELSE

C  P() {0==-1}

C
         IF (KPRESS.GT.1) LARGE = MAX(LARGE, 3*N2M*N2M)+NWEIG+NWEIG     0229

C  P() {0==-1}

         IF (KPRESS.LE.1) LARGE = MAX(LARGE+NWEIG, 3*N2M*N2M)           0230
      ENDIF

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,
C    NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8NW+127, LMAPP==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 256<=NMAX2, 2NWH<=NW,
C    NW<=2NWH+1, 4NWQ<=NW, NW<=4NWQ+3}

C
      LZN = LCMREQ(LARGE)                                               0233

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LZN,MEMSIZ,N1,N1E,
C    N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,
C    NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8NW+127, LMAPP==1, LZN==1,
C    MEMSIZ==8NW+127, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 256<=NMAX2, NW<=20623, 2NWH<=NW, NW<=2NWH+1,
C    4NWQ<=NW, NW<=4NWQ+3}

      LTN = LZN+NW                                                      0234

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LTN,LZN,MEMSIZ,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,
C    NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LMAPP==1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      IF (NOTEMP.EQ.1) LTN = LZN                                        0235

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LTN,LZN,MEMSIZ,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,
C    NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LMAPP==1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPN = LTN+NW                                                      0236

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LZN,MEMSIZ,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,
C    NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LMAPP==1,
C    LPN==2LTN-1, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      LZO = LPN+NW                                                      0237

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LTO = LZO+NW                                                      0238

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LTO,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LPN+LTN==LZO+1, LTN+LZO==LTO+1,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      IF (NOTEMP.EQ.1) LTO = LZO                                        0239

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LTN,LTO,LZN,LZO,
C    MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0, NXXRCS==0, NXXXIN==0,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPY = LTO+NW                                                      0240

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,
C    NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LTN+LTO==LPY+1, LTN+LZO==LTO+1,
C    3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      LZX = LPY+NW                                                      0241

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,LZX,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,
C    NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LTN+LTO==LPY+1, LPY+LTN==LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LZY = LZX+NW                                                      0242

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPY,LTN,LTO,LZN,
C    LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LMAPP==1, LPN==2LTN-1, LTN+LTO==LPY+1, LPY+LTN==LZX+1,
C    LTN+LZO==LTO+1, 3LTN==LZO+2, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LPRESS = LZN+LARGE-NWEIG                                          0243

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LMAPP,LPN,LPRESS,LPY,LTN,
C    LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,
C    N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LTN+LTO==LPY+1, LPY+LTN==LZX+1, 4LTN==LTO+3, 3LTN==LZO+2,
C    LTN+LZX==LZY+1, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0, NXXOUT==0,
C    NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

      LEIG = LPRESS                                                     0244

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LEIG,LMAPP,LPN,LPRESS,LPY,
C    LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LTN+LTO==LPY+1, LPY+LTN==LZX+1, LTN+LZO==LTO+1,
C    3LTN==LZO+2, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      IF (KPRESS.GT.1.AND.LMAPP.NE.1) LEIG = LPRESS-NWEIG               0245

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LEIG,LMAPP,LPN,LPRESS,LPY,
C    LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,
C    N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ) {K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0, NOALS==1,
C    NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C THESE LCM ADDRESSES ARE USED BY EIGSET AND LCMRQR
C
      LE = LZN                                                          0249

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LMAPP,LPN,LPRESS,
C    LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,
C    N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LPY+LTN==LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LH = LE+N2M*N2M                                                   0250

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 128<=LH, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      LEV = LH+N2M*N2M                                                  0251

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LPY+LTN==LZX+1,
C    4LTN==LTO+3, 3LTN==LZO+2, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
      CALL EXSET(EX, NMAX2)                                             0253

C  P(K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C SET ALL  U(I) TO 0. TO AVOID TROUBLE IF NO MEAN FLOW IS DESIRED
C
      DO 10 I = 1, N2P                                                  0257

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=129, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         U(I) = 0.                                                      0258

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, LTN+LZX==LZY+1, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=129, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

10       CONTINUE                                                       0259

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C SET UP ARRAYS ASSOCIATED WITH THE MAPPING FUNCTION:
C
      IF (LMAPP.EQ.1) THEN                                              0263

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C LINEAR MAPPING - EIGENVALUES KNOWN, EIGENFUNCTIONS ARE SIMPLY SINES
C AND COSINES, SO THAT NO MATRICES ARE NEEDED:
C
         F = H/REAL(N2)                                                 0268

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         FZ = PI/H                                                      0269

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         FZSQ = FZ*FZ                                                   0270

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         GMAPP(1) = 0.                                                  0271

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         G(1) = FZ                                                      0272

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==130, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         DO 20 I = 1, N2M                                               0273

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

            GMAPP(I+1) = F*REAL(I)                                      0274

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

            G(I+1) = FZ                                                 0275

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

            EVAL(I) = -REAL(I)**2*FZSQ                                  0276

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=127, LH+127<=LEV, 128<=LH, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

20          CONTINUE                                                    0277

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         GMAPP(N2P) = H                                                 0278

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         G(N2P) = FZ                                                    0279

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ)
C    {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==0, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL OUT(EVAL, LEIG, NWEIG)                                    0280
C
      ENDIF

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==1, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 1<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C READ THE DATA:
C
      IF (KDATA.EQ.1.OR.KDATA.EQ.2) CALL DATAST(A, N2P, N1, GMAPP)      0286

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 1<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      FX = 2.0*PI/BOXX                                                  0287

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 1<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

      FX2 = 2.*FX                                                       0288

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 1<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C PREPARE THE INPUT FOR PROCESSING:
C
      IF (KDATA.EQ.1) THEN                                              0292

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==0, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 1<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

C
C THE INPUT WAS STREAMFUNCTION IN PHYSICAL SPACE - SHUFFLE THE DATA AND
C GO TO FOURIER SPACE:
C
         CALL IN(A, LPN, NW)                                            0297

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==0, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL SHUF(A, N2P, N1, WORK)                                    0298

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         NPTS = N1                                                      0299

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NUMBER,NW,NWEIG,NWH,
C    NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128, NUM1==1,
C    NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0,
C    NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV,
C    128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2,
C    4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         NSKIP = N2P                                                    0300

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,N1,N1E,N1H,N1Q,N2,N2DM,
C    N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,
C    NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, N1==128, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128, NSKIP==129,
C    NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==0,
C    NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3,
C    NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MTRN = N2P                                                     0301

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MTRN,N1,N1E,N1H,N1Q,N2,
C    N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,
C    NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MTRN==129, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MSKIP = 1                                                      0302

C  P(I,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,KTAPE,
C    KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,LPN,
C    LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,
C    N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,
C    NUMBER,NW,NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==1, MTRN==129, N1==128, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==0,
C    NOALS==1, NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==0, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==0, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         ISIGN = -1                                                     0303

C  P(I,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,
C    KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,
C    LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,
C    N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,
C    NUMBER,NW,NWEIG,NWH,NWQ,NXSHUF,NXXOUT,NXXXIN) {I==128, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, MSKIP==1, MTRN==129, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==0, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0304

C  P(I,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,KSM,KTA,
C    KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,LH,LMAPP,
C    LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,N1,
C    N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,NPTS,
C    NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,NXXXIN)
C    {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, MSKIP==1, MTRN==129, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0305

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NMAX2,NOALS,NOTEMP,
C    NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,NXXXIN)
C    {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LZN==1, MSKIP==1, MTRN==129, N1==128, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NFTVMT==0, NOALS==1, NOTEMP==0, NPTS==128,
C    NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==0, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL RCS(A, EX)                                                0306

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==128, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         NPTS = 2*N2                                                    0307

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==129, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         NSKIP = 1                                                      0308

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==129,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         MTRN = N1H                                                     0309

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==1, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MSKIP = N2P                                                    0310

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         ISIGN = -1                                                     0311

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==1, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0312

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0313

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXLOG2,NXSHUF,NXXOUT,
C    NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==1, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NWEIG==127, NXACAC==0, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

         CALL ACAC(A, EX, WORK)                                         0314

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

C           F = 0.125/REAL(N1*N2)
         F = 0.0625/REAL(N1*N2)                                         0316

C  P(I,IEXSHF,ISIGN,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==128, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

         DO 30 J = 1, N1H                                               0317

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=J, J<=64, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

            DO 40 I = 1, N2PD                                           0318

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64, LH+127<=LEV, 128<=LH,
C    2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               A(I,J) = A(I,J)*F                                        0319

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64, LH+127<=LEV, 128<=LH,
C    2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}

40             CONTINUE                                                 0320

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LZN==1, MSKIP==129, MTRN==64,
C    N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127,
C    NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0,
C    NXXOUT==3, NXXRCS==1, NXXXIN==1, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 1<=J, J<=64, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

30          CONTINUE                                                    0321

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==3, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(A, LPN, NW)                                           0322

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==4, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(A, LZN, NW)                                           0323
      ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

C
CC*****C H E C K   F O U R I E R   C O E F F I C I E N T S**************
C
C         WRITE (6,7010) A(1,1),A(1,2),A(1,3)
C         WRITE (6,7020) A(2,1),A(2,2),A(2,3)
C         WRITE (6,7030) A(3,1),A(3,2),A(3,3)
C 7010    FORMAT(/2X,26HCHECK FOURIER COEFFICIENTS/4X,8HA(1,1) =,1PE13.6
C     1   2X,8HA(1,2) =,1PE13.6,2X,8HA(1,3) =,1PE13.6)
C 7020    FORMAT(4X,8HA(2,1) =,1PE13.6,2X,8HA(2,2) =,1PE13.6,2X,
C     1   8HA(2,3) =,1PE13.6)
C 7030    FORMAT(4X,8HA(3,1) =,1PE13.6,2X,8HA(3,2) =,1PE13.6,2X,
C     1   8HA(3,3) =,1PE13.6/)
C
C
      IF (KDATA.NE.3) THEN                                              0339

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

C                                                     2
C STREAMFUNCTION KNOWN - FIND THE VORTICITY:  Z =  DEL  (PSI):
C
         CALL IN(EVAL, LEIG, NWEIG)                                     0343

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZP,LARGE,LE,LEIG,LEV,
C    LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,
C    MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,
C    NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         KZN = LZN                                                      0344

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LZN,LZO,LZX,LZY,MEMSIZ,
C    MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,
C    NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,
C    NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         LVECT = N2M                                                    0345

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,
C    MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==1,
C    NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5,
C    NXXRCS==1, NXXXIN==2, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         LSKIP = 2                                                      0346

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NW,NWEIG,NWH,NWQ,
C    NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NWEIG==127, NXACAC==1,
C    NXLOG2==2, NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5,
C    NXXRCS==1, NXXXIN==2, TEMPHY:NCALL==0, ZETAPH:NCALL==0,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         NVECT = 2                                                      0347

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NW,NWEIG,NWH,
C    NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         NVSKIP = 1                                                     0348

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==5, NXXRCS==1, NXXXIN==2,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         DO 50 J = 1, N1H                                               0349

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-1, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            CALL IN(CWORK, KZN, N2PD)                                   0350

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            F = REAL((J-1)*(J-1))*FX*FX                                 0351

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            DO 60 I = 2, N2                                             0352

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2<=I, I<=128, 1<=J, J<=64,
C    J<=KZN, 1<=KZN, KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

               CWORK(I) = (EVAL(I-1)-F)*CWORK(I)                        0353

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 2<=I, I<=128, 1<=J, J<=64,
C    J<=KZN, 1<=KZN, KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

60             CONTINUE                                                 0354

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            CWORK(1) = -F*CWORK(1)                                      0355

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            CWORK(N2P) = 0.0                                            0356

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-4, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            CALL OUT(CWORK, KZN, N2PD)                                  0357

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-5, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J<=KZN, 1<=KZN,
C    KZN+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            KZN = KZN+N2PD                                              0358

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==NXXOUT-5, J==NXXXIN-2, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==2, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==1, NUMBER==250,
C    NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2,
C    NXPRNT==0, NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXRCS==1,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, J+258<=KZN,
C    259<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

50          CONTINUE                                                    0359

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==66,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         NPTS = 2*N2                                                    0360

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         NSKIP = 1                                                      0361

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MTRN = N1H                                                     0362

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         MSKIP = N2P                                                    0363

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         ISIGN = 1                                                      0364

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==2, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0365

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0366

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==66, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL IN(A, LZN, NW)                                            0367

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==2, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==1, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1,
C    NXXXIN==67, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

         CALL ACAC(A, EX, WORK)                                         0368

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==129,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         DO 70 J = 1, N1H                                               0369

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            DO 80 I = 1, N2PD                                           0370

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

               A(I,J) = 0.5*A(I,J)                                      0371

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

80             CONTINUE                                                 0372

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

70          CONTINUE                                                    0373

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==69, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         CALL OUT(A, LZO, NW)                                           0374

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         IF (NOTEMP.NE.1) THEN                                          0375

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            IF (KDATA.NE.1) THEN                                        0376

C  P() {0==-1}

               CALL IN(A, LTN, NW)                                      0377

C  P() {0==-1}

C
C NEW TEMPERATURE KNOWN - SET UP T(OLD):
C
               NPTS = 2*N2                                              0381

C  P() {0==-1}

               NSKIP = 1                                                0382

C  P() {0==-1}

               MTRN = N1H                                               0383

C  P() {0==-1}

               MSKIP = N2P                                              0384

C  P() {0==-1}

               ISIGN = 1                                                0385

C  P() {0==-1}

               CALL XLOG2(NPTS, LOG)                                    0386

C  P() {0==-1}

               IEXSHF = NMAX2/NPTS                                      0387

C  P() {0==-1}

               CALL ACAC(A, EX, WORK)                                   0388

C  P() {0==-1}

               DO 90 J = 1, N1H                                         0389

C  P() {0==-1}

                  DO 100 I = 1, N2PD                                    0390

C  P() {0==-1}

                     A(I,J) = A(I,J)*0.5                                0391

C  P() {0==-1}

100                  CONTINUE                                           0392

C  P() {0==-1}

90                CONTINUE                                              0393

C  P() {0==-1}

               CALL OUT(A, LTO, NW)                                     0394

            ELSE

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==67,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

C
C TEMPERATURE IS SUPPLIED IN PHYSICAL SPACE - SHUFFLE THE DATA AND
C GO TO FOURIER REPRESENTATION:
C
               CALL IN(A, LTN, NW)                                      0401

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==1, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

               CALL SHUF(A, N2P, N1, WORK)                              0402

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

               NPTS = N1                                                0403

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NSKIP = N2P                                              0404

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MTRN = N2P                                               0405

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MSKIP = 1                                                0406

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               ISIGN = -1                                               0407

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==3, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL XLOG2(NPTS, LOG)                                    0408

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               IEXSHF = NMAX2/NPTS                                      0409

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==3, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==1,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL RCS(A, EX)                                          0410

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               F = 0.5/REAL(N1)                                         0411

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               DO 110 J = 1, N1H                                        0412

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

                  DO 120 I = 1, N2PD                                    0413

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J,
C    J<=64, 322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

                     A(I,J) = F*A(I,J)                                  0414

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J,
C    J<=64, 322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

120                  CONTINUE                                           0415

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2}

110               CONTINUE                                              0416

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==70, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL OUT(A, LTO, NW)                                     0417

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==128, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NPTS = 2*N2                                              0418

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==129, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               NSKIP = 1                                                0419

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MTRN = N1H                                               0420

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               MSKIP = N2P                                              0421

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               ISIGN = -1                                               0422

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==4, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL XLOG2(NPTS, LOG)                                    0423

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               IEXSHF = NMAX2/NPTS                                      0424

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==4, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXACAC==2, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2}

               CALL ACAC(A, EX, WORK)                                   0425

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

C           F = 0.25/REAL(N2)
               F = 0.125/REAL(N2)                                       0427

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

               DO 130 J = 1, N1H                                        0428

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

                  DO 140 I = 1, N2PD                                    0429

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

                     A(I,J) = F*A(I,J)                                  0430

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=I, I<=258, 1<=J, J<=64,
C    322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

140                  CONTINUE                                           0431

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 1<=J, J<=64, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

130               CONTINUE                                              0432

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==71, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

               CALL OUT(A, LTN, NW)                                     0433
            ENDIF

         ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}


         T = 0.                                                         0438

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         DTT = DT                                                       0439

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NUMBER,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN) {I==259,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==128,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==1, NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0,
C    NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2, NXXXIN==68,
C    TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624, 2NWH+1<=LTN,
C    LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

         NSTEPS = 1                                                     0440
      ENDIF

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUMBER,NVECT,NVSKIP,
C    NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1,
C    NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}


      CALL RUNINF                                                       0443

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUMBER,NVECT,NVSKIP,
C    NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,NXXXIN)
C    {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 7LTN==LZY+6,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NFTVMT==5, NOALS==1,
C    NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==1, NUMBER==250, NUSHUF==0,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXACAC==3, NXLOG2==5, NXPRNT==0,
C    NXSCSC==0, NXSHUF==2, NXXCSR==0, NXXOUT==72, NXXRCS==2,
C    NXXXIN==68, TEMPHY:NCALL==0, ZETAPH:NCALL==0, 322<=KZN,
C    KZN<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LTN<=20624,
C    2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN, LTN<=4NWQ+4, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

      CALL BUG('AFT INITAL')                                            0444

C  P(I,IEXSHF,ISIGN,J,K1Q,K1QM,K2Q,K2QM,K3Q,K3QM,KDATA,KPF,KPP,KPRESS,
C    KSM,KTA,KTAPE,KTF,KTP,KUF,KUP,KVF,KVP,KZF,KZN,KZP,LARGE,LE,LEIG,
C    LEV,LH,LMAPP,LOG,LPN,LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,
C    LZY,MEMSIZ,MSKIP,MTRN,N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,
C    NFTVMT,NMAX2,NOALS,NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NVECT,
C    NVSKIP,NW,NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXSHUF,NXXOUT,NXXRCS,
C    NXXXIN) {I==259, ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    7LTN==LZY+6, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1==128, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NFTVMT==5, NOALS==1, NOTEMP==0, NSKIP==1, NSTEPS==1, NUM1==2,
C    NUMBER==250, NUSHUF==0, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXACAC==3, NXLOG2==5, NXPRNT==0, NXSCSC==0, NXSHUF==2, NXXCSR==0,
C    NXXOUT==72, NXXRCS==2, NXXXIN==68, TEMPHY:NCALL==0,
C    ZETAPH:NCALL==0, 322<=KZN, KZN<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LTN<=20624, 2NWH+1<=LTN, LTN<=2NWH+2, 4NWQ+1<=LTN,
C    LTN<=4NWQ+4, 256<=NMAX2, 255<=NPTS, NPTS<=256}


C#
      IF (.TRUE.) THEN                                                  0447

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

150      CONTINUE                                                       0448

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

C
C THIS IS THE BEGINNING OF THE TIME STEP.
C
         IF (MOD(NSTEPS, KTF).EQ.1.AND.NOTEMP.NE.1) CALL TEMPFO(CA,     0452
     &   N2P, N1H, CWORK)                                               0452

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

         IF (MOD(NSTEPS, KPF).EQ.1) CALL PSIFOU(CA, N2P, N1H, CWORK)    0454

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

         IF (MOD(NSTEPS, KZF).EQ.1) CALL ZETAFO(CA, N2P, N1H, CWORK)    0455

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

         IF (MOD(NSTEPS, KVF).EQ.1) CALL VVELFO(CA, N2P, N1H, FX,       0456
     &   CWORK)                                                         0456

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

         IF (MOD(NSTEPS+1, KTA).EQ.1) THEN                              0457

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

C
C TIME AVERAGE VORTICITY:
C
            DTT = DT                                                    0461

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

            T = T-0.5*DT                                                0462

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    NPTS<=256}

            CALL IN(A, LZO, NW)                                         0463

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    NPTS<=256}

            NPTS = 2*N2                                                 0464

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            NSKIP = 1                                                   0465

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            MTRN = N1H                                                  0466

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            MSKIP = N2P                                                 0467

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            ISIGN = -1                                                  0468

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            IEXSHF = NMAX2/NPTS                                         0469

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            CALL XLOG2(NPTS, LOG)                                       0470

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            CALL ACAC(A, EX, WORK)                                      0471

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            F = 0.125/REAL(N2)                                          0472

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    255<=NPTS, NPTS<=256}

            DO 160 J = 1, N1H                                           0473

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

               DO 170 I = 1, N2PD                                       0474

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

                  A(I,J) = A(I,J)*F                                     0475

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

170               CONTINUE                                              0476

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

160            CONTINUE                                                 0477

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            CALL OUT(A, LZO, NW)                                        0478

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            ISIGN = 1                                                   0479

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            MTRN = N1Q                                                  0480

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            KZN = LZN                                                   0481

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            KZO = LZO                                                   0482

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO==3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS,
C    NPTS<=256}

            DO 180 K = 1, 2                                             0483

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+3LTN<=KZO+3, 256<=K+NPTS, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, NPTS<=256}

               CALL IN(A, KZO, NWH)                                     0484

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               CALL IN(A(1,K2Q), KZN, NWH)                              0485

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2,
C    K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZO+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    NPTS<=256, 1<=NWH}

               DO 190 J = 1, N1Q                                        0486

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K,
C    K<=2, K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZN, KZN+NWH<=8LTN+120,
C    1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, NPTS<=256, 1<=NWH}

                  K2QJ = J+K2QM                                         0487

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  DO 200 I = 1, N2PD                                    0488

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                     A(I,J) = A(I,J)+0.5*A(I,K2QJ)                      0489

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

200                  CONTINUE                                           0490

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

190               CONTINUE                                              0491

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               CALL OUT(A, KZN, NWH)                                    0492

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, 256<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               CALL ACAC(A, EX, WORK)                                   0493

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               DO 210 J = 1, N1Q                                        0494

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  DO 220 I = 1, N2PD                                    0495

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                     A(I,J) = 0.5*A(I,J)                                0496

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=258, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

220                  CONTINUE                                           0497

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS,
C    1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

210               CONTINUE                                              0498

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               CALL OUT(A, KZO, NWH)                                    0499

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, 255<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZO+NWH<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               KZO = KZO+NWH                                            0500

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN+NWH==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN+NWH<=KZO+3, 255<=K+NPTS, 1<=KZN,
C    KZN+NWH<=8LTN+120, KZO<=8LTN+120, NWH+1<=KZO, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

               KZN = KZN+NWH                                            0501

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+3LTN+NWH<=KZO+3, 255<=K+NPTS,
C    KZN<=8LTN+120, NWH+1<=KZN, KZO<=8LTN+120, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

180            CONTINUE                                                 0502

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NWH}

            IF (NOTEMP.NE.1) THEN                                       0503

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NWH}

C
C TIME AVERAGE TEMPERATURE:
C
               ISIGN = -1                                               0507

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NWH}

               MTRN = N1H                                               0508

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NWH}

               CALL IN(A, LTO, NW)                                      0509

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 253<=NPTS,
C    NPTS<=256, 1<=NWH}

               CALL ACAC(A, EX, WORK)                                   0510

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               F = 0.125/REAL(N2)                                       0511

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               DO 230 J = 1, N1H                                        0512

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=64, KZN<=8LTN+120, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

                  DO 240 I = 1, N2PD                                    0513

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

                     A(I,J) = F*A(I,J)                                  0514

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=64, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

240                  CONTINUE                                           0515

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=64, KZN<=8LTN+120, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

230               CONTINUE                                              0516

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               CALL OUT(A, LTO, NW)                                     0517

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==-1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               ISIGN = 1                                                0518

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               MTRN = N1Q                                               0519

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 252<=NPTS,
C    NPTS<=256, 1<=NWH}

               KTO = LTO                                                0520

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO==4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KZN<=8LTN+120, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

               KTN = LTN                                                0521

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 4KTN==KTO+3, 3KTN+KZN==KZO+3,
C    8KTN==LARGE-119, 8KTN==LEIG+7, 2KTN==LPN+1, 8KTN==LPRESS+7,
C    5KTN==LPY+4, KTN==LTN, 4KTN==LTO+3, 3KTN==LZO+2, 6KTN==LZX+5,
C    8KTN==MEMSIZ-119, KTN==NW+1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==32, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=KTN,
C    KZN<=8KTN+120, KZO<=8KTN+120, 3KTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, 252<=NPTS, NPTS<=256, 1<=NWH}

               DO 250 K = 1, 2                                          0522

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  CALL IN(A, KTO, NWH)                                  0523

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

                  CALL IN(A(1,K2Q), KTN, NWH)                           0524

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS, 1<=KTN,
C    KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  DO 260 J = 1, N1Q                                     0525

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                     K2QJ = J+K2QM                                      0526

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                     DO 270 I = 1, N2PD                                 0527

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    253<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

                        A(I,J) = A(I,J)+0.5*A(I,K2QJ)                   0528

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==K2QJ-32,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    253<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

270                     CONTINUE                                        0529

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    253<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

260                  CONTINUE                                           0530

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  CALL OUT(A, KTN, NWH)                                 0531

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 253<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  CALL ACAC(A, EX, WORK)                                0532

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  DO 280 J = 1, N1Q                                     0533

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                     DO 290 I = 1, N2PD                                 0534

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    252<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

                        A(I,J) = 0.5*A(I,J)                             0535

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 1<=I, I<=258, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    252<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

290                     CONTINUE                                        0536

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    252<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

280                  CONTINUE                                           0537

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  CALL OUT(A, KTO, NWH)                                 0538

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, 252<=K+NPTS,
C    1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO, KTO+NWH<=8LTN+120,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 1<=NWH}

                  KTO = KTO+NWH                                         0539

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN+NWH==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN+NWH<=KTO+4,
C    252<=K+NPTS, 1<=KTN, KTN+NWH<=8LTN+120, KTO<=8LTN+120,
C    NWH+1<=KTO, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

                  KTN = KTN+NWH                                         0540

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, ISIGN==1,
C    J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==32, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN+NWH<=KTO+4,
C    252<=K+NPTS, KTN<=8LTN+120, NWH+1<=KTN, KTO<=8LTN+120,
C    NWH+1<=KTO, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256,
C    1<=NWH}

250               CONTINUE                                              0541
            ENDIF

         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, NPTS<=256}

C
C THE BEGINING OF A NORMAL TIME STEP
C (U IS X VELOCITY AND V IS Y VELOCITY)
C FIND (-U) = D(PSI)/DY
C
C
         IF (NSTEPS.LT.3) THEN                                          0551

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, NPTS<=256, NSTEPS<=2}

            CALL IN(CA, LPN, NW)                                        0552

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, NSTEPS<=2}

            CALL PSIPHY(CA, N2P, N1H, EX, G, U, WORK, CWORK3, 1)        0553

         ELSE

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, NPTS<=256, 3<=NSTEPS}

            CALL IN(CA, LPN, NW)                                        0556

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {16ISIGN+MTRN==48,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, NPTS<=256, 3<=NSTEPS}

            IF (MOD(NSTEPS, KPP).EQ.1) CALL PSIPHY(CA, N2P, N1H, EX,    0557
     &      G, U, WORK, CWORK3, -1)                                     0557
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP+NSKIP==130, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    ISIGN<=1, 65<=64ISIGN+MSKIP, LH+127<=LEV, 128<=LH, 2<=LTN,
C    MSKIP<=129, NPTS<=MSKIP+127, 256<=NMAX2}

C
         NPTS = 2*N2                                                    0561

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP+NSKIP==130, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, ISIGN<=1, 65<=64ISIGN+MSKIP, LH+127<=LEV, 128<=LH,
C    2<=LTN, MSKIP<=129, 256<=NMAX2}

         NSKIP = 1                                                      0562

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL)
C    {2048ISIGN+97MSKIP+128MTRN==18657, K1Q==17, K1QM==16, K2Q==33,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    ISIGN<=1, 65<=64ISIGN+MSKIP, LH+127<=LEV, 128<=LH, 2<=LTN,
C    MSKIP<=129, 256<=NMAX2}

         MTRN = N1H                                                     0563

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, ISIGN<=1, 65<=64ISIGN+MSKIP, LH+127<=LEV, 128<=LH,
C    2<=LTN, MSKIP<=129, 256<=NMAX2}

         MSKIP = N2P                                                    0564

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {K1Q==17, K1QM==16,
C    K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 0<=ISIGN+1, ISIGN<=1, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

         ISIGN = 1                                                      0565

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0566

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0567

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

         CALL IN(CA, LPN, NW)                                           0568

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

         F = 0.                                                         0569

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

         DO 300 I = 1, N2                                               0570

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

            DO 310 J = 1, N1H                                           0571

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0572

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

310            CONTINUE                                                 0573

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=128, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

            F = F+1.                                                    0574

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=128, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

300         CONTINUE                                                    0575

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         DO 320 J = 1, N1H                                              0576

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

            CA(N2P,J) = 0.                                              0577

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

320         CONTINUE                                                    0578

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         CALL SCSC(CA, EX, WORK)                                        0579

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(CA, LPY, NW)                                          0580

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         IF (KSM.EQ.1) CALL MEAN(CA, U, G)                              0581

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==4LPN+123, LE==1, LEIG==4LPN-3, LMAPP==1,
C    4LPN==LPRESS+3, LPN==2LTN-1, 4LPN==MEMSIZ-123, LPY==5LTN-4,
C    LSKIP==2, 3LTN==LZO+2, 6LTN==LZX+5, LTN==NW+1, LTO==4NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    3<=LPN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         IF (MOD(NSTEPS, KUF).EQ.1) CALL UVELFO(CA, N2P, N1H, G, EX,    0582
     &   CWORK)                                                         0582

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==4LPN+123, LE==1, LEIG==4LPN-3, LMAPP==1,
C    4LPN==LPRESS+3, LPN==2LTN-1, 4LPN==MEMSIZ-123, LPY==5LTN-4,
C    LSKIP==2, 3LTN==LZO+2, 6LTN==LZX+5, LTN==NW+1, LTO==4NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    3<=LPN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL IN(CA, LPN, NW)                                           0583

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

C
C FIND  V = D(PSI)/DX
C
         F = 0.                                                         0587

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         DO 330 J = 1, N1H                                              0588

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

            DO 340 I = 1, N2P                                           0589

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0590

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

340            CONTINUE                                                 0591

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

            F = F+FX                                                    0592

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

330         CONTINUE                                                    0593

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL ACAC(CA, EX, WORK)                                        0594

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         CALL OUT(CA, LPN, NW)                                          0595

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         IF (MOD(NSTEPS, KPP).EQ.1.AND.NOTEMP.NE.1) CALL IN(CA, LPN,    0596
     &   NW)                                                            0596

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==4LPN+123, LE==1, LEIG==4LPN-3, LMAPP==1,
C    LPN==2LTN-1, 3LPN==LZX+2, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         NPTS = 2*N2                                                    0597

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         NSKIP = 1                                                      0598

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         MTRN = N1H                                                     0599

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         MSKIP = N2P                                                    0600

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         ISIGN = 1                                                      0601

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0602

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0603

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

         IF (NOTEMP.NE.1) THEN                                          0604

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==LEIG+126, 3LARGE==4LZX+377, LE==1, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8NW+1, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    6LTN==LZX+5, LTN==NW+1, LVECT==127, LZN==1, LZO==3NW+1,
C    MEMSIZ==8NW+127, MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 135<=LARGE,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2}

C
C T(TOTAL) = T-BETA*Y
C WHERE BETA < 0 MEANS   STABLE STRATIFICATION AND
C       BETA > 0 MEANS UNSTABLE STRATIFICATION
C
            KTO = LTO                                                   0610

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO==4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==LEIG+126, LARGE==8LTN+119, LE==1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    135<=LARGE, LH+127<=LEV, 128<=LH, 256<=NMAX2}

            DTB = 0.5*BETA*DTT                                          0611

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO==4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LARGE==LEIG+126, LARGE==8LTN+119, LE==1,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    135<=LARGE, LH+127<=LEV, 128<=LH, 256<=NMAX2}

            DO 350 J = 1, N1H                                           0612

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

               CALL IN(CWORK, KTO, N2PD)                                0613

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

               F = -REAL(J-1)*FX*DTT*0.25                               0614

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+4LTN<=KTO+4,
C    1<=KTO, KTO+138<=8LTN, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2}

               DO 360 I = 1, N2P                                        0615

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64,
C    J+4LTN<=KTO+4, 1<=KTO, KTO+138<=8LTN, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

                  CWORK(I) = CWORK(I)*CMPLX(1., U(I)*F)+DTB*CA(I,J)     0616

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64,
C    J+4LTN<=KTO+4, 1<=KTO, KTO+138<=8LTN, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

360               CONTINUE                                              0617

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+4LTN<=KTO+4, 1<=KTO, KTO+138<=8LTN, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

               CALL OUT(CWORK, KTO, N2PD)                               0618

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+4LTN<=KTO+4, 1<=KTO, KTO+138<=8LTN, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

               KTO = KTO+N2PD                                           0619

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+4LTN+254<=KTO, 259<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

350            CONTINUE                                                 0620
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}


         CALL IN(CA, LZN, NW)                                           0623

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

C
C FIND DZ/DY:
C
         F = 0.                                                         0627

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

         DO 370 I = 1, N2                                               0628

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2}

            DO 380 J = 1, N1H                                           0629

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0630

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

380            CONTINUE                                                 0631

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=128, 259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

            F = F+1.                                                    0632

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==65,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=128, 259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

370         CONTINUE                                                    0633

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

         DO 390 J = 1, N1H                                              0634

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, 259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

            CA(N2P,J) = 0.                                              0635

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, 259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, 2<=LTN, 256<=NMAX2}

390         CONTINUE                                                    0636

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NPTS==256, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2}

         CALL SCSC(CA, EX, WORK)                                        0637

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL OUT(CA, LZY, NW)                                          0638

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL IN(CA, LZN, NW)                                           0639

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 255<=NPTS, NPTS<=256}

         CALL ACAC(CA, EX, WORK)                                        0640

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         DO 400 J = 1, N1H                                              0641

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, 259<=KTO, 4LTN+318<=KTO,
C    KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

            DO 410 I = 1, N2P                                           0642

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

               CA(I,J) = CA(I,J)*0.5                                    0643

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

410            CONTINUE                                                 0644

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

400         CONTINUE                                                    0645

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         CALL OUT(CA, LZN, NW)                                          0646

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 259<=KTO,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256}

         NPTS = N1                                                      0647

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         NSKIP = N2P                                                    0648

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         MTRN = N2P                                                     0649

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         MSKIP = 1                                                      0650

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         ISIGN = 1                                                      0651

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL XLOG2(NPTS, LOG)                                          0652

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         IEXSHF = NMAX2/NPTS                                            0653

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KTO, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    2<=LTN, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         IF (MOD(NSTEPS, KZP).EQ.1) CALL ZETAPH(CA, N2PD, N1H, EX,      0654
     &   WORK, -1)                                                      0654

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         IF (MOD(NSTEPS, KZP).EQ.1) CALL IN(CA, LZN, NW)                0655

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==2LTO-1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==LZX+2, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

C
C FIND DZ/DX:
C
         F = 0.                                                         0659

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==2LTO-1, LMAPP==1,
C    LPN==2LTN-1, 3LPN==LZX+2, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         DO 420 J = 1, N1H                                              0660

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64, 4LTN+318<=KTO,
C    KTO<=8LTN+120, LH+127<=LEV, 128<=LH, LZY<=7LTN+121, 1<=LZY,
C    256<=NMAX2}

            DO 430 I = 1, N2P                                           0661

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

               CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))      0662

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=64,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

430            CONTINUE                                                 0663

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

            F = F+FX2                                                   0664

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

420         CONTINUE                                                    0665

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL CSR(CA, EX)                                               0666

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL OUT(CA, LZX, NW)                                          0667

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL IN(CA, LZY, NW)                                           0668

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL CSR(CA, EX)                                               0669

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL OUT(CA, LZY, NW)                                          0670

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL IN(CA, LPN, NW)                                           0671

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL CSR(CA, EX)                                               0672

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL OUT(CA, LPN, NW)                                          0673

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL IN(CA, LPY, NW)                                           0674

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL CSR(CA, EX)                                               0675

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         CALL OUT(CA, LPY, NW)                                          0676

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

C
C WE ARE IN PHYSICAL SPACE NOW - FIND  (U,V).GRAD (Z):
C
         IF (MOD(NSTEPS, KUP).EQ.1) CALL UVELPH(A, N2PD, N1H, WORK,     0680
     &   -1)                                                            0680

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         IF (MOD(NSTEPS, KVP).EQ.1) CALL VVELPH(A, N2PD, N1H, WORK,     0681
     &   -1)                                                            0681

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1,
C    LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         KPY = LPY                                                      0682

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPP==249, KPRESS==1, KPY==5LTN-4, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         KPN = LPN                                                      0683

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==2LTN-1, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=8LTN+120, LH+127<=LEV,
C    128<=LH, LZY<=7LTN+121, 1<=LZY, 256<=NMAX2}

         KZY = LZY                                                      0684

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==2LTN-1, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZY==LZY, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZY,
C    KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 256<=NMAX2}

         KZX = LZX                                                      0685

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==2LTN-1, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==6LTN-5, KZY==LZY,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=8LTN+120,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 256<=NMAX2}

         UKSM1F = REAL(2-KSM)                                           0686

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, ISIGN==1,
C    J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN==2LTN-1, KPP==249, KPRESS==1, KPY==5LTN-4,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==6LTN-5, KZY==LZY,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 4LTN+318<=KTO, KTO<=8LTN+120,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 256<=NMAX2}

         DO 440 K = 1, 4                                                0687

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, LH+127<=LEV,
C    128<=LH, 256<=NMAX2}

            CALL IN(A, KPY, NWQ)                                        0688

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWQ}

            CALL IN(A(1,K1Q), KPN, NWQ)                                 0689

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN,
C    KPN+NWQ<=8LTN+120, 1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWQ}

            CALL IN(A(1,K2Q), KZY, NWQ)                                 0690

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN,
C    KPN+NWQ<=8LTN+120, 1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            CALL IN(A(1,K3Q), KZX, NWQ)                                 0691

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN,
C    KPN+NWQ<=8LTN+120, 1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZX, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN,
C    KZX+NWQ<=8LTN+120, 1<=KZY, KZY+NWQ<=8LTN+120, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWQ}

            DO 450 I = 1, N2PD                                          0692

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY, KPY+NWQ<=8LTN+120,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX, KZY<=KZX+LTN+126,
C    KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY, KZY+NWQ<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

               IPH = (I+1)/2                                            0693

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K,
C    K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

               GG = G(IPH)                                              0694

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K,
C    K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

               UU = U(IPH)*UKSM1F                                       0695

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K,
C    K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

               DO 460 J = 1, N1E                                        0696

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=J,
C    J<=16, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120,
C    1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

                  A(I,J) = A(I,J)*GG+UU                                 0697

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=J,
C    J<=16, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120,
C    1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

                  A(I,K2QM+J) = A(I,J)*A(I,K3QM+J)-A(I,K1QM+J)*A(I,     0698
     &            K2QM+J)*GG                                            0698

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=J,
C    J<=16, 1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120,
C    1<=KPY, KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

460               CONTINUE                                              0700

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==17,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K, K<=4, K+6LTN<=KZX+6,
C    1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY, KPY+NWQ<=8LTN+120,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX, KZY<=KZX+LTN+126,
C    KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY, KZY+NWQ<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

450            CONTINUE                                                 0701

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            CALL OUT(A, KPY, NWQ)                                       0702

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            CALL OUT(A(1,K2Q), KZY, NWQ)                                0703

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, 1<=KPN, KPN+NWQ<=8LTN+120, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            KPN = KPN+NWQ                                               0704

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+NWQ+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, KPN<=8LTN+120, NWQ+1<=KPN, 1<=KPY,
C    KPY+NWQ<=8LTN+120, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            KPY = KPY+NWQ                                               0705

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+NWQ+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+NWQ+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN<=KZX+6, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZX,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX+NWQ<=8LTN+120, 1<=KZY,
C    KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

            KZX = KZX+NWQ                                               0706

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZY+6LTN+NWQ==KZX+LZY+5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN+NWQ<=KZX+6, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZY+NWQ<=KZX+LTN+126, KZX+6<=KZY+6LTN+NWQ, KZX<=8LTN+120,
C    NWQ+1<=KZX, 1<=KZY, KZY+NWQ<=8LTN+120, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWQ}

            KZY = KZY+NWQ                                               0707

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=4, K+6LTN+NWQ<=KZX+6, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN, KZX<=8LTN+120, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NWQ}

440         CONTINUE                                                    0708

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

C
C [Z(OLD) + (MEAN -U) * (-DZ(OLD)/DX)] + (U,V).GRAD(Z)
C
         ISIGN = -1                                                     0712

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX+6<=KZY+6LTN,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWQ}

         CALL IN(A, LZY, NW)                                            0713

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWQ+1<=KZY,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2, 1<=NWQ}

         CALL RCS(A, EX)                                                0714

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWQ+1<=KZY,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2, 1<=NWQ}

         CALL OUT(A, LZY, NW)                                           0715

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWQ+1<=KZY,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2, 1<=NWQ}

         KZO = LZO                                                      0716

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZO==3LTN-2,
C    KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWQ}

         KZN = LZN                                                      0717

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO==3LTN-2, KZP==249, KZX+LZY==KZY+6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=KZX+LTN+126,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWQ}

         KZY = LZY                                                      0718

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO==3LTN-2, KZP==249, KZY==LZY, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZX+KZY<=14LTN+115,
C    6LTN+NWQ<=KZX+KZY+4, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWQ}

         DTFAC = 0.125*DTT/REAL(N1)                                     0719

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO==3LTN-2, KZP==249, KZY==LZY, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZX+KZY<=14LTN+115,
C    6LTN+NWQ<=KZX+KZY+4, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWQ}

         F1 = DTT*FX*0.25                                               0720

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO==3LTN-2, KZP==249, KZY==LZY, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZX+KZY<=14LTN+115,
C    6LTN+NWQ<=KZX+KZY+4, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWQ}

         F = F1                                                         0721

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO==3LTN-2, KZP==249, KZY==LZY, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZX+KZY<=14LTN+115,
C    6LTN+NWQ<=KZX+KZY+4, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY<=7LTN+121, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWQ}

         DO 470 K = 1, 2                                                0722

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 1<=NWQ}

            CALL IN(CA, KZO, NWH)                                       0723

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZO, KZX+KZY<=KZO+11LTN+117,
C    KZO+3LTN+NWQ<=KZX+KZY+2, KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN,
C    KZO+NWH<=8LTN+120, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZN, NWH)                                0724

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL OUT(CA(1,K2Q), KZO, NWH)                               0725

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZY, NWH)                                0726

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            DO 480 J = 1, N1Q                                           0727

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

               K2QJ = J+K2QM                                            0728

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

               F = F-F1                                                 0729

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

               DO 490 I = 1, N2P                                        0730

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+3LTN<=KZO+3, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZX+KZY<=KZO+11LTN+117,
C    KZO+3LTN+NWQ<=KZX+KZY+2, KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN,
C    KZO+NWH<=8LTN+120, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

                  CA(I,J) = CA(I,J)*CMPLX(1., F*U(I))+DTFAC*CA(I,K2QJ   0731
     &            )                                                     0731

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+3LTN<=KZO+3, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN,
C    KZN+NWH<=8LTN+120, 1<=KZO, KZX+KZY<=KZO+11LTN+117,
C    KZO+3LTN+NWQ<=KZX+KZY+2, KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN,
C    KZO+NWH<=8LTN+120, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

490               CONTINUE                                              0732

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+3LTN<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

480            CONTINUE                                                 0733

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            CALL OUT(CA, KZN, NWH)                                      0734

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, 1<=KZN, KZN+NWH<=8LTN+120, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            KZN = KZN+NWH                                               0735

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+NWH+3, KZO+LZY==KZY+3LTN-2, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120, NWH+1<=KZN, 1<=KZO,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO+NWH<=8LTN+120,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            KZO = KZO+NWH                                               0736

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZY+3LTN+NWH==KZO+LZY+2, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN+NWH<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120, NWH+1<=KZN,
C    KZX+KZY+NWH<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+NWH+2,
C    KZY+NWH<=KZO+4LTN+123, KZO+3<=KZY+3LTN+NWH, KZO<=8LTN+120,
C    NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            KZY = KZY+NWH                                               0737

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+3LTN+NWH<=KZO+3,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120, NWH+1<=KZN,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

470         CONTINUE                                                    0738

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0739

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 3KPN+4LZO==3KZX+4,
C    KPP==249, KPRESS==1, 3KPY+LZO==3KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZO+LZY==KZY+LZO, KZP==249, LARGE==2LTO+125,
C    LE==1, LEIG==2LTO-1, LMAPP==1, LPN==2LTN-1, 3LPN==2LZO+1,
C    3LPN==LZX+2, LPRESS==8LTN-7, LPY==5NW+1, LSKIP==2, 4LTN==LTO+3,
C    2LTO==MEMSIZ-125, LTO==4NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 3KPN<=8LZO+376, NWQ+1<=KPN,
C    3KPY<=8LZO+376, NWQ+1<=KPY, 4LZO+962<=3KTO, 3KTO<=8LZO+376,
C    3KZN<=8LZO+376, 3KZX+3KZY<=3KZO+11LZO+373, KZO+LZO+NWQ<=KZX+KZY,
C    3KZY<=3KZO+4LZO+377, KZO+1<=KZY+LZO, 3KZO<=8LZO+376,
C    LZO+NWH+1<=KZO, NWH+1<=KZO, 3KZX<=8LZO+376, 2LZO+NWQ+2<=KZX,
C    NWQ+1<=KZX, 3KZY<=8LZO+376, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    4<=LZO, 256<=NMAX2, 1<=NWH, 1<=NWQ}

C
C FIND DT/DY:
C
            NPTS = 2*N2                                                 0743

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 3KPN+4LZO==3KZX+4,
C    KPP==249, KPRESS==1, 3KPY+LZO==3KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZO+LZY==KZY+LZO, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, 2LZO==LZX+1,
C    MSKIP==1, MTRN==129, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NPTS==256, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 3KPN<=8LZO+376, NWQ+1<=KPN,
C    3KPY<=8LZO+376, NWQ+1<=KPY, 4LZO+962<=3KTO, 3KTO<=8LZO+376,
C    3KZN<=8LZO+376, 3KZX+3KZY<=3KZO+11LZO+373, KZO+LZO+NWQ<=KZX+KZY,
C    3KZY<=3KZO+4LZO+377, KZO+1<=KZY+LZO, 3KZO<=8LZO+376,
C    LZO+NWH+1<=KZO, NWH+1<=KZO, 3KZX<=8LZO+376, 2LZO+NWQ+2<=KZX,
C    NWQ+1<=KZX, 3KZY<=8LZO+376, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    4<=LZO, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            NSKIP = 1                                                   0744

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            MTRN = N1H                                                  0745

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            MSKIP = N2P                                                 0746

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            ISIGN = 1                                                   0747

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL XLOG2(NPTS, LOG)                                       0748

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            IEXSHF = NMAX2/NPTS                                         0749

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL IN(CA, LTN, NW)                                        0750

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            F = 0.                                                      0751

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            DO 500 I = 1, N2                                            0752

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               DO 510 J = 1, N1H                                        0753

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117,
C    KZO+3LTN+NWQ<=KZX+KZY+2, KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

                  CA(I,J) = CMPLX(-F*AIMAG(CA(I,J)), F*REAL(CA(I,J)))   0754

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN+3LTN==KZO+3,
C    KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, 1<=J, J<=64, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO,
C    KTO<=8LTN+120, KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117,
C    KZO+3LTN+NWQ<=KZX+KZY+2, KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

510               CONTINUE                                              0755

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               F = F+1.                                                 0756

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=128, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

500            CONTINUE                                                 0757

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            DO 520 J = 1, N1H                                           0758

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CA(N2P,J) = 0.                                           0759

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

520            CONTINUE                                                 0760

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NPTS==256, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL SCSC(CA, EX, WORK)                                     0761

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO+3<=KZY+3LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, NWH+1<=KZO, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    2<=LTN, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL OUT(CA, LZY, NW)                                       0762

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL IN(CA, LTN, NW)                                        0763

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL ACAC(CA, EX, WORK)                                     0764

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL OUT(CA, LTN, NW)                                       0765

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            NPTS = N1                                                   0766

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            NSKIP = N2P                                                 0767

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            MTRN = N2P                                                  0768

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            MSKIP = 1                                                   0769

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            CALL XLOG2(NPTS, LOG)                                       0770

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            IEXSHF = NMAX2/NPTS                                         0771

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120, KZN<=8LTN+120,
C    KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

            IF (NSTEPS.EQ.1) THEN                                       0772

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 3KPN+4LZO==3KZX+4,
C    KPP==249, KPRESS==1, 3KPY+LZO==3KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZO==KZO+1, KZO+LZY==KZY+LZO, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, 2LZO==LZX+1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NSTEPS==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 3KPN<=8LZO+376,
C    NWQ+1<=KPN, 3KPY<=8LZO+376, NWQ+1<=KPY, 4LZO+962<=3KTO,
C    3KTO<=8LZO+376, 3KZN<=8LZO+376, 3KZX+3KZY<=3KZO+11LZO+373,
C    KZO+LZO+NWQ<=KZX+KZY, 3KZY<=3KZO+4LZO+377, 3KZO<=8LZO+376,
C    LZO+NWH+1<=KZO, NWH+1<=KZO, 3KZX<=8LZO+376, 2LZO+NWQ+2<=KZX,
C    NWQ+1<=KZX, 3KZY<=8LZO+376, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    4<=LZO, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL TEMPHY(A, N2PD, N1H, EX, WORK, 0)                   0773

            ELSEIF (MOD(NSTEPS, KTP).EQ.1.OR.MOD(NSTEPS, KPP).EQ.1      0772
     &      ) THEN                                                      0772

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+3LTN==KZO+3, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, 3LPN==2LZO+1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, 2LZO==LZX+1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 4LTN+318<=KTO, KTO<=8LTN+120,
C    KZN<=8LTN+120, KZX+KZY<=KZO+11LTN+117, KZO+3LTN+NWQ<=KZX+KZY+2,
C    KZY<=KZO+4LTN+123, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, NWH+1<=KZO,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 2<=LTN, 1<=LZY, 256<=NMAX2,
C    1<=NWH, 1<=NWQ}

               CALL TEMPHY(A, N2PD, N1H, EX, WORK, -1)                  0777
            ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3LTN==KPY+3,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZY==KZY+1, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4LTN+124, KPN+LZY<=10LTN+119,
C    2LTN+NWQ+2<=KPN, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=8LTN+120,
C    KZY<=5LTN+LZY+122, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

C
C TEMPERATURE INFLUENCE:
C
            F = -FX                                                     0782

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3LTN==KPY+3,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN+LZY==KZY+1, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4LTN+124, KPN+LZY<=10LTN+119,
C    2LTN+NWQ+2<=KPN, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=8LTN+120,
C    KZY<=5LTN+LZY+122, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            KZN = LZN                                                   0783

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3LTN==KPY+3,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZN==1, KZO+LZY==KZY+3LTN-2, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4LTN+124, KPN+LZY<=10LTN+119,
C    2LTN+NWQ+2<=KPN, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=8LTN+120,
C    KZY<=5LTN+LZY+122, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            KZX = LZX                                                   0784

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3LTN==KPY+3,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1,
C    KZO+LZY==KZY+3LTN-2, KZP==249, KZX==6LTN-5, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LPY==5LTN-4, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4LTN+124, KPN+LZY<=10LTN+119,
C    2LTN+NWQ+2<=KPN, 4LTN+318<=KTO, KTO<=8LTN+120, KZY<=8LTN+120,
C    KZY<=5LTN+LZY+122, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    LZY<=7LTN+121, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            KTN = LTN                                                   0785

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KTN+KZY==KZO+LZY+2, 6KTN==KZX+5, 8KTN==LARGE-119, 8KTN==LEIG+7,
C    2KTN==LPN+1, 8KTN==LPRESS+7, 5KTN==LPY+4, KTN==LTN, 4KTN==LTO+3,
C    3KTN==LZO+2, 6KTN==LZX+5, 8KTN==MEMSIZ-119, KTN==NW+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4KTN+124, KPN+LZY<=10KTN+119,
C    2KTN+NWQ+2<=KPN, KTO<=8KTN+120, 4KTN+318<=KTO, KZY<=8KTN+120,
C    KZY<=5KTN+LZY+122, LZY<=7KTN+121, LZY+NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            DTA = 0.5*ALPHA*DTT                                         0786

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KTN+KZY==KZO+LZY+2, 6KTN==KZX+5, 8KTN==LARGE-119, 8KTN==LEIG+7,
C    2KTN==LPN+1, 8KTN==LPRESS+7, 5KTN==LPY+4, KTN==LTN, 4KTN==LTO+3,
C    3KTN==LZO+2, 6KTN==LZX+5, 8KTN==MEMSIZ-119, KTN==NW+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=4KTN+124, KPN+LZY<=10KTN+119,
C    2KTN+NWQ+2<=KPN, KTO<=8KTN+120, 4KTN+318<=KTO, KZY<=8KTN+120,
C    KZY<=5KTN+LZY+122, LZY<=7KTN+121, LZY+NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            DO 530 K = 1, 2                                             0787

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128,
C    KPN+10KZN+LZY<=10KTN+129, 2KTN+NWQ+4<=KPN+2KZN,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128,
C    5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128, LZY+NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL IN(CA, KZN, NWH)                                    0788

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128,
C    KPN+10KZN+LZY<=10KTN+129, 2KTN+NWQ+4<=KPN+2KZN,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128,
C    5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL IN(CA(1,K2Q), KTN, NWH)                             0789

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128,
C    KPN+10KZN+LZY<=10KTN+129, 2KTN+NWQ+4<=KPN+2KZN, 1<=KTN,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128,
C    5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1,
C    1<=KZN, KZN+NWH<=MEMSIZ+1, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               DO 540 J = 1, N1Q                                        0790

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                  K2QJ = J+K2QM                                         0791

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                  F = F+FX                                              0792

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                  DO 550 I = 1, N2P                                     0793

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                     CA(I,K2QJ) = CMPLX(-F*AIMAG(CA(I,K2QJ)), F*REAL(   0794
     &               CA(I,K2QJ)))                                       0794

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                     CA(I,J) = CA(I,J)+DTA*CA(I,K2QJ)                   0796

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN, KPP==249,
C    KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32,
C    1<=K, K<=2, K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

550                  CONTINUE                                           0797

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2,
C    K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

540               CONTINUE                                              0798

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               CALL OUT(CA, KZN, NWH)                                   0799

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               CALL OUT(CA(1,K2Q), KZX, NWH)                            0800

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    1<=KZX, KZX+NWH<=MEMSIZ+1, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               KZX = KZX+NWH                                            0801

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 6KTN+NWH==5KZN+KZX,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K<=KZN, KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, 1<=KTN, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    7KZN+LZY<=7KTN+128, KTN+NWH<=MEMSIZ+1, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               KTN = KTN+NWH                                            0802

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPY+3KZN+3NWH==KPN+3KTN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY+3NWH==3KTN+KZY+1, 5KZN+KZX+5NWH==6KTN,
C    8KZN+LARGE+8NWH==8KTN+127, 8KZN+LEIG+8NWH==8KTN+1,
C    2KZN+LPN+2NWH==2KTN+1, 8KZN+LPRESS+8NWH==8KTN+1,
C    5KZN+LPY+5NWH==5KTN+1, KZN+LTN+NWH==KTN+1, 4KZN+LTO+4NWH==4KTN+1,
C    3KZN+LZO+3NWH==3KTN+1, 6KZN+LZX+6NWH==6KTN+1,
C    8KZN+MEMSIZ+8NWH==8KTN+127, KZN+NW+NWH==KTN, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1,
C    LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K<=KZN, KPN+10KZN+LZY+10NWH<=10KTN+129,
C    KPN+4KZN+4NWH<=4KTN+128, 2KTN+NWQ+4<=KPN+2KZN+2NWH,
C    KTO+8KZN+8NWH<=8KTN+128, 4KTN+322<=KTO+4KZN+4NWH,
C    5KZN+KZY+5NWH<=5KTN+LZY+127, 8KZN+KZY+8NWH<=8KTN+128,
C    7KZN+LZY+7NWH<=7KTN+128, KTN<=MEMSIZ+1, NWH+1<=KTN, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               KZN = KZN+NWH                                            0803

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+3KTN==KPY+3KZN,
C    KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1, 8KZN+LPRESS==8KTN+1,
C    5KZN+LPY==5KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+NWH<=KZN,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+1<=KZN,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

530            CONTINUE                                                 0804

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL IN(A, LZX, NW)                                         0805

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL CSR(A, EX)                                             0806

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LZX, NW)                                        0807

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, 7KZN+LZY<=7KTN+128,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    1<=LZY, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(A, LZY, NW)                                         0808

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL CSR(A, EX)                                             0809

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LZY, NW)                                        0810

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+3KTN==KPY+3KZN, KPP==249, KPRESS==1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 2KZN+LPN==2KTN+1,
C    8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+4KZN<=4KTN+128, KPN+10KZN+LZY<=10KTN+129,
C    2KTN+NWQ+4<=KPN+2KZN, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KPN = LPN                                                   0811

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN==2KTN+1,
C    KPN==LPN, KPP==249, KPRESS==1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    3KZN+KZO+LZY==3KTN+KZY+1, 5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, 5KZN+LPY==5KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPY+7KZN<=7KTN+128,
C    KPY+13KZN+LZY<=13KTN+129, 5KTN+NWQ+4<=KPY+5KZN,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128,
C    5KZN+KZY<=5KTN+LZY+127, KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, KZX<=MEMSIZ+1, NWH+1<=KZX, LZY+NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

            KPY = LPY                                                   0812

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN==2KTN+1,
C    KPN==LPN, KPP==249, KPRESS==1, KPY+5KZN==5KTN+1, KPY==LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    5KZN+KZX==6KTN, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    8KZN+LZY+NWQ<=8KTN+125, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1,
C    NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, KZX<=MEMSIZ+1, NWH+1<=KZX,
C    LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, LZY+NW<=MEMSIZ+1,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZX = LZX                                                   0813

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN==2KTN+1,
C    KPN==LPN, KPP==249, KPRESS==1, KPY+5KZN==5KTN+1, KPY==LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 3KZN+KZO+LZY==3KTN+KZY+1,
C    6KZN+KZX==6KTN+1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, KZX==LZX,
C    LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZY<=8KTN+128, 5KZN+KZY<=5KTN+LZY+127,
C    8KZN+LZY+NWQ<=8KTN+125, 6KTN<=5KZN+MEMSIZ+1, 5KZN+NWH+1<=6KTN,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1,
C    NWH+2<=KZN, LZY+NWH+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY,
C    LZY+NW<=MEMSIZ+1, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            KZY = LZY                                                   0814

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN==2KTN+1,
C    KPN==LPN, KPP==249, KPRESS==1, KPY+5KZN==5KTN+1, KPY==LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 6KZN+KZX==6KTN+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX==LZX, KZY==LZY, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZO<=8KTN+128, 11KZN+KZO+KZY<=11KTN+129,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZY+NWQ<=8KTN+125,
C    6KTN<=5KZN+MEMSIZ+1, 5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZY,
C    KZY+NW<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

C
C IN PHYSICAL SPACE - FIND  (U,V).GRAD(T):
C
            DO 560 K = 1, 4                                             0818

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A, KPY, NWQ)                                     0819

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZO<=8KTN+128, 11KZN+KZO+KZY+LZX<=11KTN+KZX+129,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZY+LZX+NWQ<=8KTN+KZX+125,
C    6KTN<=5KZN+MEMSIZ+1, 5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    KZX+1<=KZY+LZX, KZY+LZX+NW<=KZX+MEMSIZ+1, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K1Q), KPN, NWQ)                              0820

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K2Q), KZY, NWQ)                              0821

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, 1<=KZY, KZY+NWQ<=MEMSIZ+1, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K3Q), KZX, NWQ)                              0822

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN,
C    KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               DO 570 I = 1, N2PD                                       0823

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 1<=K, K<=4, K+LZX<=KZX+1,
C    1<=KPN, KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

                  IPH = (I+1)/2                                         0824

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K,
C    K<=4, K+LZX<=KZX+1, 1<=KPN, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZO<=8KTN+128, 11KZN+KZO+KZY+LZX<=11KTN+KZX+129,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZY+LZX+NWQ<=8KTN+KZX+125,
C    6KTN<=5KZN+MEMSIZ+1, 5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX,
C    KZX+1<=KZY+LZX, KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1,
C    1<=KZY, KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

                  GG = G(IPH)                                           0825

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=K,
C    K<=4, K+LZX<=KZX+1, 1<=KPN, KPN+NWQ<=MEMSIZ+1, 1<=KPY,
C    KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN,
C    8KZN+KZO<=8KTN+128, 11KZN+KZO+KZY+LZX<=11KTN+KZX+129,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZY+LZX+NWQ<=8KTN+KZX+125,
C    6KTN<=5KZN+MEMSIZ+1, 5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX,
C    KZX+1<=KZY+LZX, KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1,
C    1<=KZY, KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

                  DO 580 J = 1, N1E                                     0826

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=J,
C    J<=16, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN, KPN+NWQ<=MEMSIZ+1,
C    1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

                     A(I,J) = A(I,J)*A(I,K3QM+J)-A(I,K1QM+J)*A(I,K2QM   0827
     &               +J)*GG                                             0827

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, K1Q==17,
C    K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN,
C    KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH, 2IPH<=I+1, 1<=J,
C    J<=16, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN, KPN+NWQ<=MEMSIZ+1,
C    1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

580                  CONTINUE                                           0829

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==1, J==17,
C    K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1,
C    KPN+LZX==KZX+LPN, KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1,
C    KPY+LZX==KZX+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I, I<=258, I<=2IPH,
C    2IPH<=I+1, 1<=K, K<=4, K+LZX<=KZX+1, 1<=KPN, KPN+NWQ<=MEMSIZ+1,
C    1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

570               CONTINUE                                              0830

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1,
C    KPN+LZX==KZX+LPN, KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1,
C    KPY+LZX==KZX+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1,
C    1<=KPN, KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               CALL OUT(A, KZY, NWQ)                                    0831

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1,
C    KPN+LZX==KZX+LPN, KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1,
C    KPY+LZX==KZX+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1,
C    1<=KPN, KPN+NWQ<=MEMSIZ+1, 1<=KPY, KPY+NWQ<=MEMSIZ+1,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               KPN = KPN+NWQ                                            0832

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+NWQ+1, KZX+LPN+NWQ==KPN+LZX, KPP==249,
C    KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, 1<=KPY, KPY+NWQ<=MEMSIZ+1, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               KPY = KPY+NWQ                                            0833

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+NWQ+1, KZX+LPN+NWQ==KPN+LZX, KPP==249,
C    KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+NWQ+1, KZX+LPY+NWQ==KPY+LZX,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, KZX+LZY==KZY+LZX, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX<=KZX+1, KPN<=MEMSIZ+1,
C    NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY, KTO+8KZN<=8KTN+128,
C    4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, 1<=KZX, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX+NWQ<=MEMSIZ+1, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               KZX = KZX+NWQ                                            0834

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1,
C    KPN+LZX==KZX+LPN, KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1,
C    KPY+LZX==KZX+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZY+LZX+NWQ==KZX+LZY, LE==1, LMAPP==1, LSKIP==2, LVECT==127,
C    LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX+NWQ<=KZX+1,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX+NWQ<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+2NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZY+LZX+NW+NWQ<=KZX+MEMSIZ+1,
C    KZX+1<=KZY+LZX+NWQ, KZX<=MEMSIZ+1, NWQ+1<=KZX, 1<=KZY,
C    KZY+NWQ<=MEMSIZ+1, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

               KZY = KZY+NWQ                                            0835

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+2KZN+LZX==2KTN+KZX+1,
C    KPN+LZX==KZX+LPN, KPP==249, KPRESS==1, KPY+5KZN+LZX==5KTN+KZX+1,
C    KPY+LZX==KZX+LPY, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=4, K+LZX+NWQ<=KZX+1,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, KZX<=MEMSIZ+1, NWQ+1<=KZX,
C    KZY<=MEMSIZ+1, NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    1<=NW, 1<=NWH, 1<=NWQ}

560            CONTINUE                                                 0836

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN, KPP==249, KPRESS==1,
C    KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, LZX+NWQ+3<=KZX, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            ISIGN = -1                                                  0837

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN, KPP==249, KPRESS==1,
C    KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZX+1<=KZY+LZX,
C    KZY+LZX+NW<=KZX+MEMSIZ+1, LZX+NWQ+3<=KZX, KZX<=MEMSIZ+1,
C    NWQ+1<=KZX, KZY<=MEMSIZ+1, NWQ+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NW, 1<=NWH, 1<=NWQ}

            CALL IN(A, LZY, NW)                                         0838

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN, KPP==249, KPRESS==1,
C    KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZY+LZX+NW<=KZX+MEMSIZ+1,
C    LZX+NWQ+3<=KZX, KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY<=MEMSIZ+1,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            CALL RCS(A, EX)                                             0839

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN, KPP==249, KPRESS==1,
C    KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZY+LZX+NW<=KZX+MEMSIZ+1,
C    LZX+NWQ+3<=KZX, KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY<=MEMSIZ+1,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            CALL OUT(A, LZY, NW)                                        0840

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+2KZN+LZX==2KTN+KZX+1, KPN+LZX==KZX+LPN, KPP==249, KPRESS==1,
C    KPY+5KZN+LZX==5KTN+KZX+1, KPY+LZX==KZX+LPY, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, 8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1,
C    8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1,
C    3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127,
C    KZN+NW==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1,
C    KZP==249, KZX+LZY==KZY+LZX, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=MEMSIZ+1, NWQ+1<=KPN, KPY<=MEMSIZ+1, NWQ+1<=KPY,
C    KTO+8KZN<=8KTN+128, 4KTN+322<=KTO+4KZN, 8KZN+KZO<=8KTN+128,
C    11KZN+KZO+KZY+LZX<=11KTN+KZX+129, 3KTN+NWH+2<=3KZN+KZO,
C    8KZN+KZY+LZX+NWQ<=8KTN+KZX+125, 6KTN<=5KZN+MEMSIZ+1,
C    5KZN+NWH+1<=6KTN, 2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, KZY+LZX+NW<=KZX+MEMSIZ+1,
C    LZX+NWQ+3<=KZX, KZX<=MEMSIZ+1, NWQ+1<=KZX, KZY<=MEMSIZ+1,
C    NWQ+1<=KZY, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NW,
C    1<=NWH, 1<=NWQ}

            KTN = LTN                                                   0841

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==KZX+4,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+KTN==KZX+1,
C    KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    6KTN+KZY==KZX+LZY+5, 8KTN==LARGE-119, 8KTN==LEIG+7,
C    8KTN==LPRESS+7, KTN==LTN, 4KTN==LTO+3, 3KTN==LZO+2, 6KTN==LZX+5,
C    8KTN==MEMSIZ-119, KTN==NW+1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8KTN+120, NWQ+1<=KPN, KPY<=8KTN+120, NWQ+1<=KPY, 2<=KTN,
C    KTO<=8KTN+120, 4KTN+318<=KTO, KZN<=8KTN+120, KZN<=7KTN+121,
C    KZN<=2KTN+126, NWH+7<=6KTN+KZN, NWH+2<=KTN+KZN, KZO<=8KTN+120,
C    KZO+KZY<=5KTN+KZX+123, 3KTN+NWH<=KZO+1, KZX<=8KTN+120,
C    KZY<=KTN+KZX+126, KZY+NWQ<=2KTN+KZX+122, 6KTN+NWQ<=KZX+2,
C    KZY<=8KTN+120, NWQ<=2KTN+122, NWH+2<=KZN, NWQ+1<=KZX, NWQ+1<=KZY,
C    LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            KTO = LTO                                                   0842

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==KZX+4,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+KTN==KZX+1,
C    KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    4KTN==KTO+3, 6KTN+KZY==KZX+LZY+5, 8KTN==LARGE-119, 8KTN==LEIG+7,
C    8KTN==LPRESS+7, KTN==LTN, 4KTN==LTO+3, 3KTN==LZO+2, 6KTN==LZX+5,
C    8KTN==MEMSIZ-119, KTN==NW+1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8KTN+120, NWQ+1<=KPN, KPY<=8KTN+120, NWQ+1<=KPY, 50<=KTN,
C    KZN<=8KTN+120, KZN<=7KTN+121, KZN<=2KTN+126, NWH+7<=6KTN+KZN,
C    NWH+2<=KTN+KZN, KZO<=8KTN+120, KZO+KZY<=5KTN+KZX+123,
C    3KTN+NWH<=KZO+1, KZX<=8KTN+120, KZY<=KTN+KZX+126,
C    KZY+NWQ<=2KTN+KZX+122, 6KTN+NWQ<=KZX+2, KZY<=8KTN+120,
C    NWQ<=2KTN+122, NWH+2<=KZN, NWQ+1<=KZX, NWQ+1<=KZY, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            KZY = LZY                                                   0843

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==17, K==5, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==KZX+4,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+KTN==KZX+1,
C    KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    4KTN==KTO+3, 8KTN==LARGE-119, 8KTN==LEIG+7, 8KTN==LPRESS+7,
C    KTN==LTN, 4KTN==LTO+3, 3KTN==LZO+2, 6KTN==LZX+5,
C    8KTN==MEMSIZ-119, KTN==NW+1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, KZY==LZY, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8KTN+120, NWQ+1<=KPN, KPY<=8KTN+120, NWQ+1<=KPY, 50<=KTN,
C    KZN<=8KTN+120, KZN<=7KTN+121, KZN<=2KTN+126, NWH+7<=6KTN+KZN,
C    NWH+2<=KTN+KZN, KZO<=8KTN+120, KZO+KZY<=11KTN+118,
C    3KTN+NWH<=KZO+1, KZX<=8KTN+120, KZX+KZY<=14KTN+115,
C    6KTN+NWQ<=KZX+KZY+4, 6KTN+NWQ<=KZX+2, KZY<=7KTN+121,
C    KZY+NWQ<=8KTN+117, NWQ<=2KTN+122, NWH+2<=KZN, NWQ+1<=KZX, 1<=KZY,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            DO 590 K = 1, 2                                             0844

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN,
C    NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH,
C    50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL IN(CA, KTO, NWH)                                    0845

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL IN(A(1,K2Q), KTN, NWH)                              0846

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120,
C    1<=KTO, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               DO 600 J = K2Q, N1H                                      0847

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 33<=J, J<=64, 1<=K, K<=2, K+4LTN<=KTO+4,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN,
C    KTN+NWH<=8LTN+120, 1<=KTO, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126,
C    NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                  DO 610 I = 1, N2PD                                    0848

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 33<=J, J<=64, 1<=K, K<=2,
C    K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

                     A(I,J) = 0.5*A(I,J)                                0849

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=258, 33<=J, J<=64, 1<=K, K<=2,
C    K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

610                  CONTINUE                                           0850

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 33<=J, J<=64, 1<=K, K<=2, K+4LTN<=KTO+4,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN,
C    KTN+NWH<=8LTN+120, 1<=KTO, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126,
C    NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

600               CONTINUE                                              0851

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120,
C    1<=KTO, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL OUT(A(1,K2Q), KTO, NWH)                             0852

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120,
C    1<=KTO, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               CALL IN(CA(1,K2Q), KZY, NWH)                             0853

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==259, IPH==129,
C    ISIGN==-1, J==65, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120,
C    1<=KTO, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               DO 620 J = 1, N1Q                                        0854

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN,
C    KTN+NWH<=8LTN+120, 1<=KTO, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126,
C    NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

                  K2QJ = J+K2QM                                         0855

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K+4LTN<=KTO+4,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN,
C    KTN+NWH<=8LTN+120, 1<=KTO, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO+NWH<=8LTN+120, KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126,
C    NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

                  DO 630 I = 1, N2P                                     0856

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                     CA(I,J) = CA(I,J)+DTFAC*CA(I,K2QJ)                 0857

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3,
C    KTP==50, KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=I, I<=129, 1<=J, J<=32, 1<=K, K<=2,
C    K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

630                  CONTINUE                                           0858

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

620               CONTINUE                                              0859

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               CALL OUT(CA, KTN, NWH)                                   0860

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, 1<=KTN, KTN+NWH<=8LTN+120, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               KTN = KTN+NWH                                            0861

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+NWH+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K+4LTN<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, KTN<=8LTN+120, NWH+1<=KTN, 1<=KTO,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO+NWH<=8LTN+120, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, 1<=KZY, KZY+NWH<=8LTN+120,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               KTO = KTO+NWH                                            0862

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KZY+4LTN+NWH==KTO+LZY+3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    1<=K, K<=2, K+4LTN+NWH<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, KTN<=8LTN+120, NWH+1<=KTN,
C    KZO+KZY+NWH<=KTO+7LTN+121, KZX+KZY+NWH<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+NWH+1, KZY+NWH<=KTO+3LTN+124,
C    KTO+4<=KZY+4LTN+NWH, KZY+NWH+NWQ<=KTO+4LTN+120, KTO<=8LTN+120,
C    NWH+1<=KTO, KZN<=8LTN+120, KZN<=7LTN+121, KZN<=2LTN+126,
C    NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN, NWH+2<=KZN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    1<=KZY, KZY+NWH<=8LTN+120, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH, 1<=NWQ}

               KZY = KZY+NWH                                            0863

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+6LTN==KZX+LPN+5,
C    KPN+4LTN==KZX+4, KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5,
C    KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+4LTN+NWH<=KTO+4, KPN<=8LTN+120, NWQ+1<=KPN,
C    KPY<=8LTN+120, NWQ+1<=KPY, KTN<=8LTN+120, NWH+1<=KTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=8LTN+120, NWH+1<=KTO, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

590            CONTINUE                                                 0864
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    KTN<=8LTN+120, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=8LTN+120, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}


         DTF = 0.25*DTT*FX                                              0867

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    KTN<=8LTN+120, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=8LTN+120, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

         F = -DTF                                                       0868

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY,
C    KTN<=8LTN+120, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=8LTN+120, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZN<=7LTN+121, KZN<=2LTN+126, NWH+7<=KZN+6LTN, NWH+2<=KZN+LTN,
C    NWH+2<=KZN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWQ<=2LTN+122, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

         KZN = LZN                                                      0869

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTN+3LTN==KTO+3, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==1,
C    MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN<=8LTN+120, NWQ+1<=KPN, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=8LTN+120, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=8LTN+120, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=8LTN+120, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

         KTN = LTN                                                      0870

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==KZX+4,
C    KPN+6KTN==KZX+LPN+5, KPP==249, KPRESS==1, KPY+KTN==KZX+1,
C    KPY+6KTN==KZX+LPY+5, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    4KTN+KZY==KTO+LZY+3, 8KTN==LARGE-119, 8KTN==LEIG+7,
C    8KTN==LPRESS+7, KTN==LTN, 4KTN==LTO+3, 3KTN==LZO+2, 6KTN==LZX+5,
C    8KTN==MEMSIZ-119, KTN==NW+1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN<=8KTN+120, NWQ+1<=KPN, KPY<=8KTN+120, NWQ+1<=KPY, 50<=KTN,
C    KTO<=11KTN+117, KTO<=8KTN+120, KZO+KZY<=7KTN+KTO+121,
C    KZX+KZY<=10KTN+KTO+118, 2KTN+KTO+NWQ<=KZX+KZY+1, KTO+4<=4KTN+KZY,
C    KZY<=3KTN+KTO+124, KZY+NWQ<=4KTN+KTO+120, 3KTN+NWH<=KTO+2,
C    4KTN+NWH<=KTO+2, KZO<=8KTN+120, 3KTN+NWH<=KZO+1, KZX<=8KTN+120,
C    6KTN+NWQ<=KZX+2, KZY<=8KTN+120, NWH<=14KTN+113, NWH<=13KTN+114,
C    NWH<=9KTN+118, NWH<=8KTN+118, NWH<=7KTN+119, NWH<=3KTN+124,
C    NWH<=2KTN+124, NWQ<=2KTN+122, NWH+1<=KTO, NWQ+1<=KZX, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         DO 640 K = 1, 2                                                0871

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    NWH+1<=KTO, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

            IF (NOTEMP.NE.1) CALL IN(CA, KTN, NWH)                      0872

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, NWQ+1<=KZX,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL IN(CA(1,K2Q), KZN, NWH)                                0873

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

            DO 650 J = 1, N1Q                                           0874

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1,
C    KPP==249, KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=32, 1<=K, K<=2, K<=KZN,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    1<=KTN, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

               K2QJ = J+K2QM                                            0875

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               F = F+DTF                                                0876

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

               IF (NOTEMP.NE.1) THEN                                    0877

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

                  DO 660 I = 1, N2P                                     0878

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

                     WORK(I) = F*U(I)                                   0879

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

                     CA(I,J) = CMPLX(1.0, -WORK(I))*CA(I,J)/(1.0+WORK   0880
     &               (I)*WORK(I))                                       0880

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

660                  CONTINUE                                           0882
               ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}


               DO 670 I = 1, N2P                                        0885

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

                  WORK(I) = F*U(I)                                      0886

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

                  CA(I,K2QJ) = CMPLX(1.0, -WORK(I))*CA(I,K2QJ)/(1.0+    0887
     &            WORK(I)*WORK(I))                                      0887

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=129, 1<=J, J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128,
C    NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

670               CONTINUE                                              0889

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==K2QJ-32, K1Q==17, K1QM==16, K2Q==33, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=32, 1<=K, K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

650            CONTINUE                                                 0890

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

            IF (NOTEMP.NE.1) CALL OUT(CA, KTN, NWH)                     0891

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

            CALL OUT(CA(1,K2Q), KZN, NWH)                               0892

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, 1<=KTN, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN+NWH<=MEMSIZ+1, NWH+1<=KTO, 1<=KZN,
C    KZN+NWH<=MEMSIZ+1, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 1<=NWH, 1<=NWQ}

            KTN = KTN+NWH                                               0893

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    6KZN+KZX+LPN+6NWH==KPN+6KTN+1, 4KZN+KZX+4NWH==KPN+4KTN, KPP==249,
C    KPRESS==1, 6KZN+KZX+LPY+6NWH==KPY+6KTN+1, KZN+KZX+NWH==KPY+KTN,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY+4NWH==4KTN+KZY+1,
C    8KZN+LARGE+8NWH==8KTN+127, 8KZN+LEIG+8NWH==8KTN+1,
C    8KZN+LPRESS+8NWH==8KTN+1, KZN+LTN+NWH==KTN+1,
C    4KZN+LTO+4NWH==4KTN+1, 3KZN+LZO+3NWH==3KTN+1,
C    6KZN+LZX+6NWH==6KTN+1, 8KZN+MEMSIZ+8NWH==8KTN+127,
C    KZN+NW+NWH==KTN, KTP==50, KUF==1, KUP==249, KVF==1, KVP==249,
C    KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2, LVECT==127, LZN==1,
C    MSKIP==1, MTRN==129, N1==NPTS, N1E==16, N1H==64, N1Q==32,
C    N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258,
C    NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2, NUMBER==250, NVECT==2,
C    NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K, K<=2, K<=KZN,
C    KPN+8KZN+8NWH<=8KTN+128, NWQ+1<=KPN, KPY+8KZN+8NWH<=8KTN+128,
C    NWQ+1<=KPY, 7KZN+KZO+KZY+7NWH<=7KTN+KTO+128,
C    10KZN+KZX+KZY+10NWH<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY+2NWH, KTO+4KZN+4NWH<=4KTN+KZY,
C    3KZN+KZY+3NWH<=3KTN+KTO+127, 4KZN+KZY+4NWH+NWQ<=4KTN+KTO+124,
C    KTO+11KZN+11NWH<=11KTN+128, KTO+8KZN+8NWH<=8KTN+128,
C    3KTN+1<=KTO+3KZN+2NWH, 4KTN+2<=KTO+4KZN+3NWH,
C    8KZN+KZO+8NWH<=8KTN+128, 3KTN+2<=3KZN+KZO+2NWH,
C    8KZN+KZX+8NWH<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX+6NWH,
C    8KZN+KZY+8NWH<=8KTN+128, 14KZN+15NWH<=14KTN+127,
C    13KZN+14NWH<=13KTN+127, 9KZN+10NWH<=9KTN+127,
C    8KZN+9NWH<=8KTN+126, 7KZN+8NWH<=7KTN+126, 3KZN+4NWH<=3KTN+127,
C    2KZN+3NWH<=2KTN+126, KZN+NWH+49<=KTN, 2KZN+2NWH+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO, 1<=KZN, KZN+NWH<=MEMSIZ+1,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

            KZN = KZN+NWH                                               0894

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN+4KTN==4KZN+KZX,
C    6KZN+KZX+LPN==KPN+6KTN+1, KPP==249, KPRESS==1, KPY+KTN==KZN+KZX,
C    6KZN+KZX+LPY==KPY+6KTN+1, KSM==1, KTA==50, KTAPE==0, KTF==1,
C    KTO+4KZN+LZY==4KTN+KZY+1, 8KZN+LARGE==8KTN+127,
C    8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1, KZN+LTN==KTN+1,
C    4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1, 6KZN+LZX==6KTN+1,
C    8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LVECT==127, LZN==1, MSKIP==1, MTRN==129, N1==NPTS, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==129, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=K,
C    K<=2, K+NWH<=KZN, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+1<=KZN,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

640         CONTINUE                                                    0895

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1==NPTS, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

         NPTS = 2*N2                                                    0896

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==129, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN,
C    KPY+8KZN<=8KTN+128, NWQ+1<=KPY, KTO+11KZN<=11KTN+128,
C    KTO+8KZN<=8KTN+128, 7KZN+KZO+KZY<=7KTN+KTO+128,
C    10KZN+KZX+KZY<=10KTN+KTO+128, 2KTN+KTO+NWQ+1<=2KZN+KZX+KZY,
C    KTO+4KZN<=4KTN+KZY, 3KZN+KZY<=3KTN+KTO+127,
C    4KZN+KZY+NWQ<=4KTN+KTO+124, 3KTN+NWH+1<=KTO+3KZN,
C    4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN, 8KZN+KZO<=8KTN+128,
C    3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128, 6KTN+NWQ+4<=6KZN+KZX,
C    8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127, 13KZN+NWH<=13KTN+127,
C    9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126, 7KZN+NWH<=7KTN+126,
C    3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126, 2KZN+NWQ<=2KTN+124,
C    KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO, KZN<=MEMSIZ+1, NWH+2<=KZN,
C    NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 1<=NWH,
C    1<=NWQ}

         NSKIP = 1                                                      0897

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==129,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         MTRN = N1H                                                     0898

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==1, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         MSKIP = N2P                                                    0899

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         ISIGN = -1                                                     0900

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         IEXSHF = NMAX2/NPTS                                            0901

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         CALL XLOG2(NPTS, LOG)                                          0902

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         CALL IN(A, LZN, NW)                                            0903

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NPTS==256,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128,
C    NWQ+1<=KPY, KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 1<=NWH, 1<=NWQ}

         CALL ACAC(A, EX, WORK)                                         0904

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         CALL OUT(A, LZN, NW)                                           0905

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0906

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL IN(A, LTN, NW)                                         0907

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 255<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL ACAC(A, EX, WORK)                                      0908

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL OUT(A, LTN, NW)                                        0909
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+4KTN==4KZN+KZX, 6KZN+KZX+LPN==KPN+6KTN+1, KPP==249,
C    KPRESS==1, KPY+KTN==KZN+KZX, 6KZN+KZX+LPY==KPY+6KTN+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+4KZN+LZY==4KTN+KZY+1,
C    8KZN+LARGE==8KTN+127, 8KZN+LEIG==8KTN+1, 8KZN+LPRESS==8KTN+1,
C    KZN+LTN==KTN+1, 4KZN+LTO==4KTN+1, 3KZN+LZO==3KTN+1,
C    6KZN+LZX==6KTN+1, 8KZN+MEMSIZ==8KTN+127, KZN+NW==KTN, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KPN+8KZN<=8KTN+128, NWQ+1<=KPN, KPY+8KZN<=8KTN+128, NWQ+1<=KPY,
C    KTO+11KZN<=11KTN+128, KTO+8KZN<=8KTN+128,
C    7KZN+KZO+KZY<=7KTN+KTO+128, 10KZN+KZX+KZY<=10KTN+KTO+128,
C    2KTN+KTO+NWQ+1<=2KZN+KZX+KZY, KTO+4KZN<=4KTN+KZY,
C    3KZN+KZY<=3KTN+KTO+127, 4KZN+KZY+NWQ<=4KTN+KTO+124,
C    3KTN+NWH+1<=KTO+3KZN, 4KTN+NWH+2<=KTO+4KZN, KZN+49<=KTN,
C    8KZN+KZO<=8KTN+128, 3KTN+NWH+2<=3KZN+KZO, 8KZN+KZX<=8KTN+128,
C    6KTN+NWQ+4<=6KZN+KZX, 8KZN+KZY<=8KTN+128, 14KZN+NWH<=14KTN+127,
C    13KZN+NWH<=13KTN+127, 9KZN+NWH<=9KTN+127, 8KZN+NWH<=8KTN+126,
C    7KZN+NWH<=7KTN+126, 3KZN+NWH<=3KTN+127, 2KZN+NWH<=2KTN+126,
C    2KZN+NWQ<=2KTN+124, KTN<=MEMSIZ+1, NWH+1<=KTN, NWH+1<=KTO,
C    KZN<=MEMSIZ+1, NWH+2<=KZN, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV,
C    128<=LH, 256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}


         KZN = LZN                                                      0912

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1,
C    KPN+6LTN==KZX+LPN+5, KPN+4LTN==KZX+4, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZN==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, KPN<=8LTN+120,
C    NWQ+1<=KPN, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=8LTN+120,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

         KPN = LPN                                                      0913

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         F2 = 1./(4.*REAL(N2))                                          0914

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         F1 = RNU*DTT                                                   0915

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C FIND PRESSURE NOW OR NEVER (IF REQUIRED...)
C
         CALL IN(EVAL, LEIG, NWEIG)                                     0919

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         LVECT = N2M                                                    0920

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         LSKIP = 2                                                      0921

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         NVECT = 2                                                      0922

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         NVSKIP = 1                                                     0923

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         FXSQ = FX*FX                                                   0924

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==130, IPH==129,
C    ISIGN==-1, J==33, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KPN==2LTN-1,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZN==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C UPDATE VORTICITY AND FIND THE NEW STREAMFUNCTION:
C
         DO 680 J = 1, N1H                                              0928

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            CALL IN(CWORK, KZN, N2PD)                                   0929

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

            F = REAL((J-1)*(J-1))*FXSQ                                  0930

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

            DO 690 I = 2, N2                                            0931

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

               CWORK(I) = CWORK(I)*F2/(1.0-F1*(EVAL(I-1)-F))            0932

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

               CWORK2(I) = CWORK(I)/(EVAL(I-1)-F)                       0933

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

690            CONTINUE                                                 0934

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

            CWORK(1) = CWORK(1)*F2/(1.0+F1*F)                           0935

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

            CWORK2(1) = 0.0                                             0936

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN<=KPN+2, KPY<=8LTN+120, NWQ+1<=KPY, KTN<=9LTN+119,
C    KTN<=8LTN+120, LTN+NWH+1<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, 1<=KZN, KZN+138<=8LTN, KZO<=8LTN+120,
C    3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3,
C    6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY,
C    LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114,
C    NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124,
C    NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    1<=NWH, 1<=NWQ}

            IF (F.NE.0.0) CWORK2(1) = -CWORK(1)/F                       0937

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2NW==KPN, KPP==249,
C    KPRESS==1, KPY+6NW==KZX+LPY-1, KPY+NW==KZX, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4NW+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==LEIG+126,
C    LARGE==LPRESS+126, 3LARGE==8LZO+373, LARGE==MEMSIZ,
C    LARGE==8NW+127, LE==1, LMAPP==1, LPN==2LTN-1, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, LVECT==127, LZN==1, LZX==6NW+1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+2NW<=KPN, KPY<=8NW+128,
C    NWQ+1<=KPY, KTN<=9NW+128, KTN<=8NW+128, NW+NWH+2<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7NW+128, KZX+KZY<=KTO+10NW+128,
C    KTO+2NW+NWQ+1<=KZX+KZY, KTO<=KZY+4NW, KZY<=KTO+3NW+127,
C    KZY+NWQ<=KTO+4NW+124, KTO<=11NW+128, KTO<=8NW+128,
C    3NW+NWH+1<=KTO, 4NW+NWH+2<=KTO, NWH+1<=KTO, 1<=KZN, KZN+130<=8NW,
C    KZO<=8NW+128, 3NW+NWH+2<=KZO, KZX<=12NW+128, KZX<=8NW+128,
C    4NW+NWQ+1<=KZX, 6NW+NWQ+4<=KZX, NWQ+1<=KZX, KZY<=8NW+128,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 49<=NW, NWH<=14NW+127, NWH<=13NW+127, NWH<=9NW+127,
C    NWH<=8NW+126, NWH<=7NW+126, NWH<=3NW+127, NWH<=2NW+126,
C    NWQ<=2NW+124, 1<=NWH, 1<=NWQ}

            CWORK(N2P) = 0.0                                            0938

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2NW==KPN, KPP==249,
C    KPRESS==1, KPY+6NW==KZX+LPY-1, KPY+NW==KZX, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4NW+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==LEIG+126,
C    LARGE==LPRESS+126, 3LARGE==8LZO+373, LARGE==MEMSIZ,
C    LARGE==8NW+127, LE==1, LMAPP==1, LPN==2LTN-1, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, LVECT==127, LZN==1, LZX==6NW+1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+2NW<=KPN, KPY<=8NW+128,
C    NWQ+1<=KPY, KTN<=9NW+128, KTN<=8NW+128, NW+NWH+2<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7NW+128, KZX+KZY<=KTO+10NW+128,
C    KTO+2NW+NWQ+1<=KZX+KZY, KTO<=KZY+4NW, KZY<=KTO+3NW+127,
C    KZY+NWQ<=KTO+4NW+124, KTO<=11NW+128, KTO<=8NW+128,
C    3NW+NWH+1<=KTO, 4NW+NWH+2<=KTO, NWH+1<=KTO, 1<=KZN, KZN+130<=8NW,
C    KZO<=8NW+128, 3NW+NWH+2<=KZO, KZX<=12NW+128, KZX<=8NW+128,
C    4NW+NWQ+1<=KZX, 6NW+NWQ+4<=KZX, NWQ+1<=KZX, KZY<=8NW+128,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 49<=NW, NWH<=14NW+127, NWH<=13NW+127, NWH<=9NW+127,
C    NWH<=8NW+126, NWH<=7NW+126, NWH<=3NW+127, NWH<=2NW+126,
C    NWQ<=2NW+124, 1<=NWH, 1<=NWQ}

            CWORK2(N2P) = 0.0                                           0939

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2NW==KPN, KPP==249,
C    KPRESS==1, KPY+6NW==KZX+LPY-1, KPY+NW==KZX, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4NW+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==LEIG+126,
C    LARGE==LPRESS+126, 3LARGE==8LZO+373, LARGE==MEMSIZ,
C    LARGE==8NW+127, LE==1, LMAPP==1, LPN==2LTN-1, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, LVECT==127, LZN==1, LZX==6NW+1,
C    MSKIP==129, MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128,
C    N2DM==255, N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1,
C    NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1,
C    NWEIG==127, NXSHUF==2, 1<=J, J<=64, J+2NW<=KPN, KPY<=8NW+128,
C    NWQ+1<=KPY, KTN<=9NW+128, KTN<=8NW+128, NW+NWH+2<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7NW+128, KZX+KZY<=KTO+10NW+128,
C    KTO+2NW+NWQ+1<=KZX+KZY, KTO<=KZY+4NW, KZY<=KTO+3NW+127,
C    KZY+NWQ<=KTO+4NW+124, KTO<=11NW+128, KTO<=8NW+128,
C    3NW+NWH+1<=KTO, 4NW+NWH+2<=KTO, NWH+1<=KTO, 1<=KZN, KZN+130<=8NW,
C    KZO<=8NW+128, 3NW+NWH+2<=KZO, KZX<=12NW+128, KZX<=8NW+128,
C    4NW+NWQ+1<=KZX, 6NW+NWQ+4<=KZX, NWQ+1<=KZX, KZY<=8NW+128,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 49<=NW, NWH<=14NW+127, NWH<=13NW+127, NWH<=9NW+127,
C    NWH<=8NW+126, NWH<=7NW+126, NWH<=3NW+127, NWH<=2NW+126,
C    NWQ<=2NW+124, 1<=NWH, 1<=NWQ}

            CALL OUT(CWORK, KZN, N2PD)                                  0940

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2NW==KPN, KPP==249,
C    KPRESS==1, KPY+6NW==KZX+LPY-1, KPY+NW==KZX, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4NW+1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8NW+127, LE==1,
C    LEIG==8NW+1, LMAPP==1, LPN==2LTN-1, LPRESS==8NW+1, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, LTN==NW+1, LVECT==127, LZN==1,
C    LZX==6NW+1, MEMSIZ==8NW+127, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2NW<=KPN, KPY<=8NW+128, NWQ+1<=KPY, KTN<=9NW+128,
C    KTN<=8NW+128, NW+NWH+2<=KTN, NWH+1<=KTN, KZO+KZY<=KTO+7NW+128,
C    KZX+KZY<=KTO+10NW+128, KTO+2NW+NWQ+1<=KZX+KZY, KTO<=KZY+4NW,
C    KZY<=KTO+3NW+127, KZY+NWQ<=KTO+4NW+124, KTO<=11NW+128,
C    KTO<=8NW+128, 3NW+NWH+1<=KTO, 4NW+NWH+2<=KTO, NWH+1<=KTO, 1<=KZN,
C    KZN+130<=8NW, KZO<=8NW+128, 3NW+NWH+2<=KZO, KZX<=12NW+128,
C    KZX<=8NW+128, 4NW+NWQ+1<=KZX, 6NW+NWQ+4<=KZX, NWQ+1<=KZX,
C    KZY<=8NW+128, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 49<=NW, NWH<=14NW+127, NWH<=13NW+127,
C    NWH<=9NW+127, NWH<=8NW+126, NWH<=7NW+126, NWH<=3NW+127,
C    NWH<=2NW+126, NWQ<=2NW+124, 1<=NWH, 1<=NWQ}

            CALL OUT(CWORK2, KPN, N2PD)                                 0941

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN<=KPN+2, 1<=KPN, KPN+138<=8LTN, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, 1<=KZN,
C    KZN+138<=8LTN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            KPN = KPN+N2PD                                              0942

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN-256, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN+256<=KPN, 259<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, 1<=KZN,
C    KZN+138<=8LTN, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            KZN = KZN+N2PD                                              0943

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+2LTN+256<=KPN, 259<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, 259<=KZN,
C    KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116,
C    KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX,
C    KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN,
C    NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118,
C    NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

680         CONTINUE                                                    0944

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C DE-ALIASE UPDATED FIELDS IF REQUESTED:
C
         IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LZN)                 0948

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LPN)                 0949

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         IF (NOTEMP.NE.1) THEN                                          0950

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+LPN==KPN+1,
C    KPP==249, KPRESS==1, 2KPY+LPN==2KZX+1, KPY+3LPN==KZX+LPY+2,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+2LPN-1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, 2LPN==LTO+1,
C    3LPN==2LZO+1, LPRESS==8LTN-7, LSKIP==2, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, LPN+321<=KPN, KPN<=4LPN+124, KPY<=4LPN+124,
C    NWQ+1<=KPY, KTN<=4LPN+124, 2KTN<=9LPN+247, LPN+2NWH+3<=2KTN,
C    NWH+1<=KTN, 2KZO+2KZY<=2KTO+7LPN+249, KZX+KZY<=KTO+5LPN+123,
C    KTO+LPN+NWQ<=KZX+KZY, 2KZY<=2KTO+3LPN+251, KTO+2<=KZY+2LPN,
C    KZY+NWQ<=KTO+2LPN+122, KTO<=4LPN+124, 2KTO<=11LPN+245,
C    2LPN+NWH<=KTO, 3LPN+2NWH<=2KTO+1, NWH+1<=KTO, KZN<=4LPN+124,
C    KZO<=4LPN+124, 3LPN+2NWH+1<=2KZO, KZX<=6LPN+122, KZX<=4LPN+124,
C    2LPN+NWQ<=KZX+1, 3LPN+NWQ+1<=KZX, NWQ+1<=KZX, KZY<=4LPN+124,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 99<=LPN, 2NWH<=13LPN+241,
C    2NWH<=9LPN+245, NWH<=7LPN+120, 2NWH<=7LPN+245, NWH<=4LPN+122,
C    2NWH<=3LPN+251, NWH<=LPN+125, NWQ<=LPN+123, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C UPDATE TEMPERATURE:
C
            IF (NOALS.EQ.1) CALL IN(EVAL, LEIG, NWEIG)                  0954

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, KTN<=9LTN+119, KTN<=8LTN+120, LTN+NWH+1<=KTN,
C    NWH+1<=KTN, KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            KTN = LTN                                                   0955

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 2KTN+KZN==KPN+2,
C    KPP==249, KPRESS==1, KPY+KTN==KZX+1, KPY+6KTN==KZX+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 4KTN+KZY==KTO+LZY+3, 8KTN==LARGE-119,
C    8KTN==LEIG+7, 2KTN==LPN+1, 8KTN==LPRESS+7, KTN==LTN, 4KTN==LTO+3,
C    3KTN==LZO+2, 6KTN==LZX+5, 8KTN==MEMSIZ-119, KTN==NW+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, 2KTN+320<=KPN, KPN<=8KTN+120, KPY<=8KTN+120,
C    NWQ+1<=KPY, 50<=KTN, KTO<=11KTN+117, KTO<=8KTN+120,
C    KZO+KZY<=7KTN+KTO+121, KZX+KZY<=10KTN+KTO+118,
C    2KTN+KTO+NWQ<=KZX+KZY+1, KTO+4<=4KTN+KZY, KZY<=3KTN+KTO+124,
C    KZY+NWQ<=4KTN+KTO+120, 3KTN+NWH<=KTO+2, 4KTN+NWH<=KTO+2,
C    KZN<=8KTN+120, KZO<=8KTN+120, 3KTN+NWH<=KZO+1, KZX<=12KTN+116,
C    KZX<=8KTN+120, 4KTN+NWQ<=KZX+3, 6KTN+NWQ<=KZX+2, KZY<=8KTN+120,
C    NWH<=14KTN+113, NWH<=13KTN+114, NWH<=9KTN+118, NWH<=8KTN+118,
C    NWH<=7KTN+119, NWH<=3KTN+124, NWH<=2KTN+124, NWQ<=2KTN+122,
C    NWH+1<=KTO, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            F1 = RKAPA*DTT                                              0956

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 2KTN+KZN==KPN+2,
C    KPP==249, KPRESS==1, KPY+KTN==KZX+1, KPY+6KTN==KZX+LPY+5, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, 4KTN+KZY==KTO+LZY+3, 8KTN==LARGE-119,
C    8KTN==LEIG+7, 2KTN==LPN+1, 8KTN==LPRESS+7, KTN==LTN, 4KTN==LTO+3,
C    3KTN==LZO+2, 6KTN==LZX+5, 8KTN==MEMSIZ-119, KTN==NW+1, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LE==1,
C    LMAPP==1, LSKIP==2, LVECT==127, LZN==1, MSKIP==129, MTRN==64,
C    N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257,
C    N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1,
C    NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    259<=KPN, 2KTN+320<=KPN, KPN<=8KTN+120, KPY<=8KTN+120,
C    NWQ+1<=KPY, 50<=KTN, KTO<=11KTN+117, KTO<=8KTN+120,
C    KZO+KZY<=7KTN+KTO+121, KZX+KZY<=10KTN+KTO+118,
C    2KTN+KTO+NWQ<=KZX+KZY+1, KTO+4<=4KTN+KZY, KZY<=3KTN+KTO+124,
C    KZY+NWQ<=4KTN+KTO+120, 3KTN+NWH<=KTO+2, 4KTN+NWH<=KTO+2,
C    KZN<=8KTN+120, KZO<=8KTN+120, 3KTN+NWH<=KZO+1, KZX<=12KTN+116,
C    KZX<=8KTN+120, 4KTN+NWQ<=KZX+3, 6KTN+NWQ<=KZX+2, KZY<=8KTN+120,
C    NWH<=14KTN+113, NWH<=13KTN+114, NWH<=9KTN+118, NWH<=8KTN+118,
C    NWH<=7KTN+119, NWH<=3KTN+124, NWH<=2KTN+124, NWQ<=2KTN+122,
C    NWH+1<=KTO, NWQ+1<=KZX, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

            DO 700 J = 1, N1H                                           0957

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, KZO+KZY<=KTO+7LTN+121,
C    KZX+KZY<=KTO+10LTN+118, KTO+2LTN+NWQ<=KZX+KZY+1,
C    KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN, KZY+NWQ<=KTO+4LTN+120,
C    KTO<=11LTN+117, KTO<=8LTN+120, 3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2,
C    NWH+1<=KTO, KZN<=8LTN+120, KZO<=8LTN+120, 3LTN+NWH<=KZO+1,
C    KZX<=12LTN+116, KZX<=8LTN+120, 4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2,
C    NWQ+1<=KZX, KZY<=8LTN+120, NWH+1<=KZY, LH+127<=LEV, 128<=LH,
C    50<=LTN, NWH<=14LTN+113, NWH<=13LTN+114, NWH<=9LTN+118,
C    NWH<=8LTN+118, NWH<=7LTN+119, NWH<=3LTN+124, NWH<=2LTN+124,
C    NWQ<=2LTN+122, 256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               CALL IN(CWORK, KTN, N2PD)                                0958

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               F = REAL((J-1)*(J-1))*FXSQ                               0959

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J, J<=64,
C    J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               DO 710 I = 2, N2                                         0960

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

                  CWORK(I) = CWORK(I)*F2/(1.0-F1*(EVAL(I-1)-F))         0961

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {IPH==129, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32, K3Q==49,
C    K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1,
C    KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50, KTAPE==0,
C    KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3,
C    3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119, LTN==NW+1,
C    LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16, N1H==64,
C    N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127, N2P==129,
C    N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2, NUMBER==250,
C    NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 2<=I, I<=128, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

710               CONTINUE                                              0962

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               CWORK(1) = CWORK(1)*F2/(1.0+F1*F)                        0963

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               CWORK(N2P) = 0.0                                         0964

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               CALL OUT(CWORK, KTN, N2PD)                               0965

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN<=KTN+1, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 1<=KTN, KTN+138<=8LTN,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

               KTN = KTN+N2PD                                           0966

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64, K2QM==32,
C    K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249,
C    KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1, KTA==50,
C    KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1,
C    LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=J,
C    J<=64, J+LTN+257<=KTN, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120,
C    KPY<=8LTN+120, NWQ+1<=KPY, 259<=KTN, KTN<=8LTN+120,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

700            CONTINUE                                                 0967

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, KZN+2LTN==KPN+2,
C    KPP==249, KPRESS==1, KPY+6LTN==KZX+LPY+5, KPY+LTN==KZX+1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+4LTN-3, KTP==50, KUF==1,
C    KUP==249, KVF==1, KVP==249, KZF==1, KZP==249, LARGE==8LTN+119,
C    LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7,
C    LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, 2LTN+320<=KPN, KPN<=8LTN+120, KPY<=8LTN+120,
C    NWQ+1<=KPY, 259<=KTN, LTN+321<=KTN, KTN<=8LTN+120,
C    KZO+KZY<=KTO+7LTN+121, KZX+KZY<=KTO+10LTN+118,
C    KTO+2LTN+NWQ<=KZX+KZY+1, KZY<=KTO+3LTN+124, KTO+4<=KZY+4LTN,
C    KZY+NWQ<=KTO+4LTN+120, KTO<=11LTN+117, KTO<=8LTN+120,
C    3LTN+NWH<=KTO+2, 4LTN+NWH<=KTO+2, NWH+1<=KTO, KZN<=8LTN+120,
C    KZO<=8LTN+120, 3LTN+NWH<=KZO+1, KZX<=12LTN+116, KZX<=8LTN+120,
C    4LTN+NWQ<=KZX+3, 6LTN+NWQ<=KZX+2, NWQ+1<=KZX, KZY<=8LTN+120,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 50<=LTN, NWH<=14LTN+113,
C    NWH<=13LTN+114, NWH<=9LTN+118, NWH<=8LTN+118, NWH<=7LTN+119,
C    NWH<=3LTN+124, NWH<=2LTN+124, NWQ<=2LTN+122, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C DE-ALIASE IF REQUESTED:
C
            IF (NOALS.EQ.1) CALL DEALSE(CA, N2P, N1H, LTN)              0971
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 2KZN+LTO==2KPN+1,
C    KPP==249, KPRESS==1, 2KPY+3LTO==2KZX+2LPY+1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, LTO+643<=2KPN, KPN<=2LTO+126, KPY<=2LTO+126,
C    NWQ+1<=KPY, 259<=KTN, LTO+1287<=4KTN, KTN<=2LTO+126,
C    4KZO+4KZY<=4KTO+7LTO+505, 2KZX+2KZY<=2KTO+5LTO+251,
C    2KTO+LTO+2NWQ+1<=2KZX+2KZY, 4KZY<=4KTO+3LTO+505, KTO+1<=KZY+LTO,
C    KZY+NWQ<=KTO+LTO+123, KTO<=2LTO+126, 4KTO<=11LTO+501,
C    3LTO+4NWH+1<=4KTO, LTO+NWH+1<=KTO, NWH+1<=KTO, KZN<=2LTO+126,
C    KZO<=2LTO+126, 3LTO+4NWH+5<=4KZO, KZX<=3LTO+125, KZX<=2LTO+126,
C    LTO+NWQ<=KZX, 3LTO+2NWQ+5<=2KZX, NWQ+1<=KZX, KZY<=2LTO+126,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 197<=LTO, 4NWH<=13LTO+495,
C    4NWH<=9LTO+499, 2NWH<=7LTO+247, 4NWH<=7LTO+497, 4NWH<=3LTO+505,
C    NWH<=2LTO+124, 2NWH<=LTO+251, 2NWQ<=LTO+247, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

C
C AT LAST, THE END OF THE TIME STEP:
C
         DTT = DT+DT                                                    0976

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 2KZN+LTO==2KPN+1,
C    KPP==249, KPRESS==1, 2KPY+3LTO==2KZX+2LPY+1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, LTO+643<=2KPN, KPN<=2LTO+126, KPY<=2LTO+126,
C    NWQ+1<=KPY, 259<=KTN, LTO+1287<=4KTN, KTN<=2LTO+126,
C    4KZO+4KZY<=4KTO+7LTO+505, 2KZX+2KZY<=2KTO+5LTO+251,
C    2KTO+LTO+2NWQ+1<=2KZX+2KZY, 4KZY<=4KTO+3LTO+505, KTO+1<=KZY+LTO,
C    KZY+NWQ<=KTO+LTO+123, KTO<=2LTO+126, 4KTO<=11LTO+501,
C    3LTO+4NWH+1<=4KTO, LTO+NWH+1<=KTO, NWH+1<=KTO, KZN<=2LTO+126,
C    KZO<=2LTO+126, 3LTO+4NWH+5<=4KZO, KZX<=3LTO+125, KZX<=2LTO+126,
C    LTO+NWQ<=KZX, 3LTO+2NWQ+5<=2KZX, NWQ+1<=KZX, KZY<=2LTO+126,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 197<=LTO, 4NWH<=13LTO+495,
C    4NWH<=9LTO+499, 2NWH<=7LTO+247, 4NWH<=7LTO+497, 4NWH<=3LTO+505,
C    NWH<=2LTO+124, 2NWH<=LTO+251, 2NWQ<=LTO+247, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         T = T+DT                                                       0977

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {I==129, IPH==129,
C    ISIGN==-1, J==65, K==3, K1Q==17, K1QM==16, K2Q==33, K2QJ==64,
C    K2QM==32, K3Q==49, K3QM==48, KDATA==1, KPF==1, 2KZN+LTO==2KPN+1,
C    KPP==249, KPRESS==1, 2KPY+3LTO==2KZX+2LPY+1, 4KPY+LTO==4KZX+1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTO+LZY==KZY+LTO, KTP==50,
C    KUF==1, KUP==249, KVF==1, KVP==249, KZF==1, KZP==249,
C    LARGE==8LTN+119, LE==1, LEIG==8LTN-7, LMAPP==1, LPN==2LTN-1,
C    LPRESS==8LTN-7, LSKIP==2, 4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5,
C    8LTN==MEMSIZ-119, LTN==NW+1, LVECT==127, LZN==1, MSKIP==129,
C    MTRN==64, N1E==16, N1H==64, N1Q==32, N2==128, N2DM==255,
C    N2DP==257, N2M==127, N2P==129, N2PD==258, NOALS==1, NOTEMP==0,
C    NSKIP==1, NUM1==2, NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127,
C    NXSHUF==2, 259<=KPN, LTO+643<=2KPN, KPN<=2LTO+126, KPY<=2LTO+126,
C    NWQ+1<=KPY, 259<=KTN, LTO+1287<=4KTN, KTN<=2LTO+126,
C    4KZO+4KZY<=4KTO+7LTO+505, 2KZX+2KZY<=2KTO+5LTO+251,
C    2KTO+LTO+2NWQ+1<=2KZX+2KZY, 4KZY<=4KTO+3LTO+505, KTO+1<=KZY+LTO,
C    KZY+NWQ<=KTO+LTO+123, KTO<=2LTO+126, 4KTO<=11LTO+501,
C    3LTO+4NWH+1<=4KTO, LTO+NWH+1<=KTO, NWH+1<=KTO, KZN<=2LTO+126,
C    KZO<=2LTO+126, 3LTO+4NWH+5<=4KZO, KZX<=3LTO+125, KZX<=2LTO+126,
C    LTO+NWQ<=KZX, 3LTO+2NWQ+5<=2KZX, NWQ+1<=KZX, KZY<=2LTO+126,
C    NWH+1<=KZY, LH+127<=LEV, 128<=LH, 197<=LTO, 4NWH<=13LTO+495,
C    4NWH<=9LTO+499, 2NWH<=7LTO+247, 4NWH<=7LTO+497, 4NWH<=3LTO+505,
C    NWH<=2LTO+124, 2NWH<=LTO+251, 2NWQ<=LTO+247, 256<=NMAX2,
C    254<=NPTS, NPTS<=256, 1<=NWH, 1<=NWQ}

         NSTEPS = NSTEPS+1                                              0978

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256, 1<=NWH,
C    1<=NWQ}

         IF (NUMBER.GE.NSTEPS) GOTO 150                                 0979
C#
      ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

C
      WRITE (6, 9010) TXXXIN, TXXOUT, TXXRCS, TXXCSR, TXSCSC, TXACAC    0983
     &, TFTVMT, TXSHUF, TUSHUF, TXPRNT, TXLOG2                          0983

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (6, 9020) EXXRCS, EXXCSR, EXSCSC, EXACAC, EFTVMT            0985

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (6, 9030) NXXXIN, NXXOUT, NXXRCS, NXXCSR, NXSCSC, NXACAC    0986
     &, NFTVMT, NXSHUF, NUSHUF, NXPRNT, NXLOG2                          0986

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==2,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

C
      CALL BUG('AFTER  ALL')                                            0989

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

C
      CALL CPUTIM(CPU2)                                                 0991

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      CALL ELAPSE(TCLCK2)                                               0992

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

C
      TWALL = MOD(TCLCK2-TCLCK1+1000000.0, 1000000.0)                   0994

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (6, 9040) TWALL                                             0995

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (1, *)                                                      0996

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (1, *) 'ELAPSED CPU TIME IN SECONDS: ', CPU2-CPU1           0997

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

C MFLOPS RATE = MFLOP 1 CPU CRAY X-MP/CPU TIME
      WRITE (1, *) 'MFLOPS RATE: ', 1657.863/(CPU2-CPU1)                0999

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (1, *) 'ELAPSED WALLCLOCK TIME IN SECONDS: ', TWALL         1000

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (1, 9050)                                                   1001

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      WRITE (1, 9080) (CDAT(I), I = 1, 15)                              1002

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      VALID = 1                                                         1003

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    VALID==1, KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

      DO 720 I = 1, 15                                                  1004

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=15, KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

         IF (I.EQ.3.OR.I.EQ.13) THEN                                    1005

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 3<=I,
C    I<=13, KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

            IF (ABS(CDAT(I)).GT.ABS(VDAT(I))) VALID = 0                 1006

         ELSEIF (ABS(VDAT(I)-CDAT(I)).GT.ABS(.01*VDAT(I))) THEN         1005

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, KZN+2LTN==KPN+2, KPP==249, KPRESS==1, KSM==1,
C    KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249, KVF==1,
C    KVP==249, KZF==1, KZP==249, LARGE==8LTN+119, LE==1, LEIG==8LTN-7,
C    LMAPP==1, LPN==2LTN-1, LPRESS==8LTN-7, LPY==5LTN-4, LSKIP==2,
C    4LTN==LTO+3, 3LTN==LZO+2, 6LTN==LZX+5, 8LTN==MEMSIZ-119,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=15, KZN+LZY+NWQ<=KPN+8LTN+120, KPN+NWQ<=KZN+8LTN+LZY+118,
C    KZN+NWQ<=KPN+3LTN+124, KZN+NWQ<=KPN+2LTN+125,
C    KPN+NWQ<=KZN+14LTN+113, KPN+NWQ<=KZN+13LTN+114,
C    KPN+NWQ<=KZN+8LTN+116, 65<=KZN, KZO<=11LTN+117, KZO<=8LTN+120,
C    KZO+LZY<=11LTN+118, 3LTN+NWH<=KZO+LZY+1, 3LTN+NWH<=KZO+1,
C    NWH+1<=KZO, LH+127<=LEV, 128<=LH, 2<=LTN, LZY<=7LTN+121,
C    LZY+NWQ<=14LTN+114, LZY+NWQ<=13LTN+115, LZY+NWQ<=8LTN+117,
C    NWQ<=3LTN+LZY+123, NWQ<=2LTN+LZY+124, NWH<=8LTN+118,
C    NWQ<=9LTN+118, NWQ<=8LTN+119, NWQ<=7LTN+120, NWQ<=3LTN+121,
C    NWQ<=2LTN+122, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256,
C    251<=NSTEPS, 1<=NWH, 1<=NWQ}

            VALID = 0                                                   1009
         ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {ISIGN==-1, K==3,
C    K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 4KZN+LARGE==4KPN+127, 4KZN+LEIG==4KPN+1,
C    KZN+LPN==KPN+1, 4KZN+LPRESS==4KPN+1, 5KZN+2LPY==5KPN+2,
C    KZN+2LTN==KPN+2, 2KZN+LTO==2KPN+1, 3KZN+2LZO==3KPN+2,
C    3KZN+LZX==3KPN+1, 4KZN+MEMSIZ==4KPN+127, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2, 1<=I,
C    I<=15, KZN+2<=KPN, 4KZN+KZO<=4KPN+128,
C    11KZN+2KZO+2LZY<=11KPN+258, 3KPN+2NWH+4<=3KZN+2KZO,
C    7KZN+2LZY<=7KPN+256, 4KZN+LZY+NWQ<=4KPN+125, KZN+NWQ<=KPN+124,
C    65<=KZN, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 251<=NSTEPS, 1<=NWH, 1<=NWQ}


720      CONTINUE                                                       1012

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 4KZN+LARGE==4KPN+127, 4KZN+LEIG==4KPN+1,
C    KZN+LPN==KPN+1, 4KZN+LPRESS==4KPN+1, 5KZN+2LPY==5KPN+2,
C    KZN+2LTN==KPN+2, 2KZN+LTO==2KPN+1, 3KZN+2LZO==3KPN+2,
C    3KZN+LZX==3KPN+1, 4KZN+MEMSIZ==4KPN+127, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+2<=KPN, 4KZN+KZO<=4KPN+128, 11KZN+2KZO+2LZY<=11KPN+258,
C    3KPN+2NWH+4<=3KZN+2KZO, 7KZN+2LZY<=7KPN+256,
C    4KZN+LZY+NWQ<=4KPN+125, KZN+NWQ<=KPN+124, 65<=KZN, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256, 251<=NSTEPS,
C    1<=NWH, 1<=NWQ}

C
      IF (VALID.EQ.1) THEN                                              1014

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 4KZN+LARGE==4KPN+127, 4KZN+LEIG==4KPN+1,
C    KZN+LPN==KPN+1, 4KZN+LPRESS==4KPN+1, 5KZN+2LPY==5KPN+2,
C    KZN+2LTN==KPN+2, 2KZN+LTO==2KPN+1, 3KZN+2LZO==3KPN+2,
C    3KZN+LZX==3KPN+1, 4KZN+MEMSIZ==4KPN+127, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    VALID==1, KZN+2<=KPN, 4KZN+KZO<=4KPN+128,
C    11KZN+2KZO+2LZY<=11KPN+258, 3KPN+2NWH+4<=3KZN+2KZO,
C    7KZN+2LZY<=7KPN+256, 4KZN+LZY+NWQ<=4KPN+125, KZN+NWQ<=KPN+124,
C    65<=KZN, LH+127<=LEV, 128<=LH, 1<=LZY, 256<=NMAX2, 254<=NPTS,
C    NPTS<=256, 251<=NSTEPS, 1<=NWH, 1<=NWQ}

         WRITE (1, 9060)                                                1015

      ELSE

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 4KZN+LARGE==4KPN+127, 4KZN+LEIG==4KPN+1,
C    KZN+LPN==KPN+1, 4KZN+LPRESS==4KPN+1, 5KZN+2LPY==5KPN+2,
C    KZN+2LTN==KPN+2, 2KZN+LTO==2KPN+1, 3KZN+2LZO==3KPN+2,
C    3KZN+LZX==3KPN+1, 4KZN+MEMSIZ==4KPN+127, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+2<=KPN, 4KZN+KZO<=4KPN+128, 11KZN+2KZO+2LZY<=11KPN+258,
C    3KPN+2NWH+4<=3KZN+2KZO, 7KZN+2LZY<=7KPN+256,
C    4KZN+LZY+NWQ<=4KPN+125, KZN+NWQ<=KPN+124, 65<=KZN, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256, 251<=NSTEPS,
C    1<=NWH, 1<=NWQ}

         WRITE (1, 9070)                                                1018
      ENDIF

C  P(I,IEXSHF,IPH,ISIGN,J,K,K1Q,K1QM,K2Q,K2QJ,K2QM,K3Q,K3QM,KDATA,KPF,
C    KPN,KPP,KPRESS,KPY,KSM,KTA,KTAPE,KTF,KTN,KTO,KTP,KUF,KUP,KVF,KVP,
C    KZF,KZN,KZO,KZP,KZX,KZY,LARGE,LE,LEIG,LEV,LH,LMAPP,LOG,LPN,
C    LPRESS,LPY,LSKIP,LTN,LTO,LVECT,LZN,LZO,LZX,LZY,MEMSIZ,MSKIP,MTRN,
C    N1,N1E,N1H,N1Q,N2,N2DM,N2DP,N2M,N2P,N2PD,NFTVMT,NMAX2,NOALS,
C    NOTEMP,NPTS,NSKIP,NSTEPS,NUM1,NUMBER,NUSHUF,NVECT,NVSKIP,NW,
C    NWEIG,NWH,NWQ,NXACAC,NXLOG2,NXPRNT,NXSCSC,NXSHUF,NXXCSR,NXXOUT,
C    NXXRCS,NXXXIN,TEMPHY:NCALL,VALID,ZETAPH:NCALL) {I==16, ISIGN==-1,
C    K==3, K1Q==17, K1QM==16, K2Q==33, K2QM==32, K3Q==49, K3QM==48,
C    KDATA==1, KPF==1, 4KZN+LARGE==4KPN+127, 4KZN+LEIG==4KPN+1,
C    KZN+LPN==KPN+1, 4KZN+LPRESS==4KPN+1, 5KZN+2LPY==5KPN+2,
C    KZN+2LTN==KPN+2, 2KZN+LTO==2KPN+1, 3KZN+2LZO==3KPN+2,
C    3KZN+LZX==3KPN+1, 4KZN+MEMSIZ==4KPN+127, KPP==249, KPRESS==1,
C    KSM==1, KTA==50, KTAPE==0, KTF==1, KTP==50, KUF==1, KUP==249,
C    KVF==1, KVP==249, KZF==1, KZP==249, LE==1, LMAPP==1, LSKIP==2,
C    LTN==NW+1, LVECT==127, LZN==1, MSKIP==129, MTRN==64, N1E==16,
C    N1H==64, N1Q==32, N2==128, N2DM==255, N2DP==257, N2M==127,
C    N2P==129, N2PD==258, NOALS==1, NOTEMP==0, NSKIP==1, NUM1==3,
C    NUMBER==250, NVECT==2, NVSKIP==1, NWEIG==127, NXSHUF==2,
C    KZN+2<=KPN, 4KZN+KZO<=4KPN+128, 11KZN+2KZO+2LZY<=11KPN+258,
C    3KPN+2NWH+4<=3KZN+2KZO, 7KZN+2LZY<=7KPN+256,
C    4KZN+LZY+NWQ<=4KPN+125, KZN+NWQ<=KPN+124, 65<=KZN, LH+127<=LEV,
C    128<=LH, 1<=LZY, 256<=NMAX2, 254<=NPTS, NPTS<=256, 251<=NSTEPS,
C    1<=NWH, 1<=NWQ}


      STOP                                                              1021

C  P() {0==-1}


9000  FORMAT(1X,'OUTPUT FOR PERFECT CLUB BENCHMARK: OCEAN INSTRUMENTED V
     &ERSION',/,1X,'$Revision: 1.A.1 $ $Author: psharma $',/)           1023

C  P() {0==-1}

C


9010  FORMAT(/,2X,'SUBROUTINE    IN, EX-TIME FOR FIRST CALL =',1P,E13.6,
     &' SECONDS',/,2X,'SUBROUTINE   OUT, EX-TIME FOR FIRST CALL =',1P,E1
     &3.6,/,2X,'SUBROUTINE   RCS, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2
     &X,'SUBROUTINE   CSR, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBR
     &OUTINE  SCSC, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE 
     & ACAC, EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE FTRVMT 
     &EX-TIME FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE  SHUF, EX-TIME
     & FOR FIRST CALL =',1P,E13.6,/,2X,'SUBROUTINE UNSHUF EX-TIME FOR FI
     &RST CALL =',1P,E13.6,/,2X,'SUBROUTINE RPRINT EX-TIME FOR FIRST CAL
     &L =',1P,E13.6,/,2X,'SUBROUTINE XLOG2, EX-TIME FOR FIRST CALL =',1P
     &,E13.6)                                                           1027

C  P() {0==-1}


9020  FORMAT(/,2X,'SUBROUTINE   RCS, EX-TIME LAST TIMESTEP  =',1P,E13.6,
     &' SECONDS',/,2X,'SUBROUTINE   CSR, EX-TIME LAST TIMESTEP  =',1P,E1
     &3.6,/,2X,'SUBROUTINE  SCSC, EX-TIME LAST TIMESTEP  =',1P,E13.6,/,2
     &X,'SUBROUTINE  ACAC, EX-TIME LAST TIMESTEP  =',1P,E13.6,/,2X,'SUBR
     &OUTINE FTRVMT EX-TIME LAST TIMESTEP  =',1P,E13.6)                 1043

C  P() {0==-1}



9030  FORMAT(/,2X,'SUBROUTINE    IN, CUMULATIVE CALLS TO    =',I12,/,2X,
     &'SUBROUTINE   OUT, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE 
     &  RCS, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE   CSR, CUMUL
     &ATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE  SCSC, CUMULATIVE CALLS 
     &TO    =',I12,/,2X,'SUBROUTINE  ACAC, CUMULATIVE CALLS TO    =',I12
     &,/,2X,'SUBROUTINE FTRVMT CUMULATIVE CALLS TO    =',I12,/,2X,'SUBRO
     &UTINE  SHUF, CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE UNSHUF
     & CUMULATIVE CALLS TO    =',I12,/,2X,'SUBROUTINE RPRINT CUMULATIVE 
     &CALLS TO    =',I12,/,2X,'SUBROUTINE XLOG2, CUMULATIVE CALLS TO    
     &=',I12)                                                           1051

C  P() {0==-1}

9040  FORMAT(/,2X,'MEASURE OF WALL-CLOCK TIME (ENVIRONMENT SENSITIVE)',/
     &,2X,'FOR EXECUTION ONLY =',1P,E13.6,1X,'SECONDS')                 1064

C  P() {0==-1}

C
9050  FORMAT(/,1X,'VALIDATION PARAMETERS:',/)                           1067

C  P() {0==-1}

9060  FORMAT(/,/,1X,'RESULTS FOR THIS RUN ARE:   VALID')                1068

C  P() {0==-1}

9070  FORMAT(/,/,1X,'RESULTS FOR THIS RUN ARE: INVALID')                1069

C  P() {0==-1}

9080  FORMAT(5E15.5)                                                    1070

      END
